"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["diffs"],{70499:(e,t,n)=>{var r,o,s,l,i,a=n(59753),c=n(3126);function d(e){""===e.style.transform?e.style.transform="rotate(180deg)":e.style.transform=""}(0,a.on)("click",".js-conversation-menu-button",function(){let e=!0;return async function(t){if(!1===e){let e=t.currentTarget,n=e.closest(".select-menu"),r=n.querySelector("details-menu");if(!r)return;r.textContent="";let o=`${r.getAttribute("src")}?instrument=1`,s=await fetch(o);s.ok&&(r.innerHTML=await s.text())}e=!1}}()),(0,a.on)("click",".js-conversations-menu-item",function(e){let t=e.currentTarget,n=t.closest(".js-conversations-details");n.hasAttribute("open")&&n.removeAttribute("open"),window.location.hash=t.hash,(0,c.kc)(document)}),(0,a.on)("click",".js-resolved-conversations",async function(e){let t=e.currentTarget.querySelector(".dropdown-caret"),n=e.currentTarget.querySelector(".select-menu-header");d(t),n.classList.toggle("border-bottom-0")});var u=n(56959),f=n(81574),m=n(36071),g=n(33537);function h({currentTarget:e}){let t=e.hasAttribute("open"),n=e.closest(".js-file-header");n.classList.toggle("has-open-dropdown",t)}function p(e){let t=document.querySelector(".js-file-filter");if(!t)return;let n=y();for(let t of n)t.checked=e;let r=j();r&&(r.checked=!e);let o=v();_(o),x(o),k(),C(),M(),(0,g.X)(o,T(),b(),S(),w(),q(),L(),E())}function b(){let e=Array.from(y()).filter(e=>e.checked);return e.map(e=>e.value)}function y(){return document.querySelectorAll(".js-diff-file-type-option")}function j(){let e=document.querySelector(".js-deleted-files-toggle");if(e instanceof HTMLInputElement)return e}function v(){return A()||L()||E()||S()||q()}function S(){return w().length>0}function w(){let e=document.querySelectorAll(".js-diff-owner-option"),t=Array.from(e).filter(e=>e.checked);return t.map(e=>e.value)}function A(){return b().length!==y().length}function q(){let e=document.querySelector(".js-manifests-option");return!!e&&e.checked}function L(){let e=j();return!!e&&!e.checked}function E(){let e=document.querySelector(".js-viewed-files-toggle");return!!e&&!e.checked}function T(){let e=new URLSearchParams(window.location.search);return e.has("w")}function _(e){let t=document.querySelector(".js-file-filter-text");t.classList.toggle("color-fg-accent",e)}function x(e){let t=document.querySelector(".js-reset-filters"),n=document.querySelector(".js-commits-filtered");null==t||n||(t.hidden=!e)}function C(){let e=A(),t=document.querySelector(".js-file-filter-select-all-container"),n=t.getAttribute(e?"data-select-all-markup":"data-all-selected-markup");t.textContent=n,t.classList.toggle("color-fg-muted",!e),t.classList.toggle("color-fg-accent",e)}function k(){let e=y(),t=L();for(let n of e)if(t){let e="0"===n.getAttribute("data-non-deleted-files-count");n.disabled=e}else n.disabled=!1}function M(){let e=document.querySelectorAll(".js-file-type-count");for(let t of e){let e=L()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",n=t.getAttribute(e);n&&(t.textContent=n)}}function R(){let e=document.querySelector(".js-file-filter-blankslate");if(!e)return;let t=document.querySelectorAll(".js-diff-progressive-loader");if(t.length>0){e.hidden=!0;return}let n=document.querySelectorAll(".js-file");if(0===n.length){e.hidden=!0;return}let r=Array.from(n).some(e=>!e.hidden);e.hidden=r}(0,a.on)("details:toggled-group",".js-file.js-details-container",function(e){e.target===e.currentTarget&&p(e.detail.open)}),(0,a.on)("details:toggled",".js-file.js-details-container",function(e){if(e.target!==e.currentTarget)return;let t=e.currentTarget;t.getBoundingClientRect().top<0&&(0,c.zT)(t)}),(0,f.Z)(()=>{let e=window.location.hash.slice(1);if(!e)return;let t=document.getElementsByName(e)[0];if(!t)return;let n=t.nextElementSibling;n&&n.matches(".js-file.js-details-container")&&(n.classList.add("open"),n.classList.add("Details--on"))}),(0,m.N7)(".js-file-header-dropdown",{subscribe:e=>(0,u.RB)(e,"toggle",h)}),(0,a.on)("click",".js-jump-to-menu-item",function({currentTarget:e}){let t=e.getAttribute("href").substring(1),n=document.querySelector(`[data-anchor="${t}"]`);if(n){let e=n.closest(".js-file.js-details-container");e.hidden=!1}R()});var I=n(78232),H=n(47851),F=n(69567),P=n(58700),$=n(34892),D=n(67525),N=n(65935);let O="```suggestion",B=RegExp(`${O}(?:.*)
`,"i"),W=RegExp("```(\n|$)");function U(e,t){let n=e.slice(0,t).split("\n");return e.split("\n")[n.length-1]}function z(e){let t=/^(\s+)/.exec(e);return t&&t[0]||""}function Q(e){return`${O}
${e}
\`\`\``}function X(e,t,n=0){let r=t.substring(n,t.length),o=e.exec(r);return o?o.index+n:-1}function Z(e,t){let n=[],r=0,o=-1;for(;(o=X(B,e,r))>-1;){r=o+O.length;let t=X(W,e,r);if(-1===t)return!1;r=t+3,n.push([o,t])}return n.some(e=>t>e[0]&&t<e[1])}function K(e){let t=e.selectionStart;if(!Z(e.value,t))return!1;let n=e.value,r=U(n,t);if(null===r)return!1;let o=z(r),s=`
${o}`,l=n.substr(0,t)+s+n.substr(t);(0,P.Se)(e,l);let i=t+s.length;return e.setSelectionRange(i,i),!0}function V(e,t){let n=Q(e),r=t.selectionStart,o=t.value,s=X(/\n/,o,r),l=""===o.trim(),i=U(o,r),a=""===i.trim(),c=o,d=0;if(l)d=(c=n).length-4;else if(-1===s)d=a?(c=o+n).length-4:(c=[o,n].join("\n")).length-4;else if(a){let e=z(i),t=r-e.length,l=o.substring(0,t),a=o.substring(s,o.length);d=(c=[l,n,a].join("")).length-a.length-4}else if(Z(o,r)){let e=X(/```/,o,r)+3,t=o.substring(0,e),s=o.substring(e,o.length);d=(c=[t,"\n",n,s].join("")).length-s.length-4}else{let e=o.substring(0,s),t=o.substring(s,o.length);d=(c=[e,"\n",n,t].join("")).length-t.length-4}(0,P.Se)(t,c),t.focus(),t.setSelectionRange(d,d)}var Y=n(254),G=n(22971);let J={addToBatchEnabled:".js-add-to-batch-enabled",unchangedSuggestion:".js-unchanged-suggestion",closedOrMergedPull:".js-closed-pull",viewingSubset:".js-viewing-subset-changes",leftBlob:".js-validation-on-left-blob",rightBlob:".js-validation-on-right-blob",outdatedComment:".js-outdated-comment",resolvedThread:".js-resolved-thread",pendingReview:".js-pending-review",isMultiLine:".js-is-multiline",inMergeQueue:".js-in-merge-queue"};function ee(e){let t=e.getAttribute("data-lines");if(null!=t){let n=e.closest(".js-suggested-changes-container"),r=n.querySelector(".js-comment-field");V(t,r)}}function et(e,t){let n=document.querySelectorAll(".js-apply-suggestion-button"),r=e.querySelector(".js-disabled-apply-suggestion-button");for(let e of n){let n=r.cloneNode(!0);er(n,t),e.closest("details").replaceWith(n)}}function en(e){let t=document.querySelector(".js-batched-suggested-changes-container");for(let n of(t&&t.classList.add("d-none"),document.querySelectorAll(".js-apply-single-suggestion")))n.classList.remove("d-none"),n.disabled=!0,n.setAttribute("aria-label",e);for(let t of document.querySelectorAll(".js-batched-suggested-changes-add"))t.classList.remove("d-none"),t.disabled=!0,t.setAttribute("aria-label",e);for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}function er(e,t){e.setAttribute("aria-label",t),e.classList.remove("d-none")}function eo(e,t){let n=document.querySelector(".js-suggested-changes-inline-validation-template").cloneNode(!0);n.classList.remove("js-suggested-changes-inline-validation-template");let r=n.querySelector(".js-suggested-changes-inline-error-message");r.textContent=e.trim();let o=t.parentNode;o.insertBefore(n,t.nextSibling)}function es(e){let t=document.querySelector(".js-suggested-changes-subset-files");if(!t)return;let n=e.querySelectorAll(".js-suggested-change-toolbar-item"),r=J.viewingSubset;if(!r)return;let o=document.querySelector(r).textContent.trim();for(let e of n){e.setAttribute("aria-disabled","true");let t=e.getAttribute("aria-describedby"),n=document.getElementById(t);n.textContent=o}}function el(e){let t=e.closest(".js-review-state-classes"),n=t.querySelectorAll("[data-pending-batched-suggestion]").length;for(let e of document.querySelectorAll(".js-pending-batched-suggested-changes-count"))e.textContent=String(n);let r=document.querySelector(".js-reenable-add-to-batch").textContent;for(let e of document.querySelectorAll("[data-batched-suggestion-reenable-sibling]"))e.removeAttribute("data-batched-suggestion-reenable-sibling"),e.removeAttribute("disabled"),e.setAttribute("aria-label",r);if(n>0){e.hidden=!1;let t=e.querySelector(".js-batched-suggested-changes-toggle");for(let e of(t.classList.add("anim-pulse-in"),t.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0}),document.querySelectorAll(".js-apply-single-suggestion")))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")||"true"===t.getAttribute("data-comment-pending")||"true"===t.getAttribute("data-outdated-comment")?e.classList.add("d-none"):e.classList.remove("d-none"),"true"===e.getAttribute("data-batched-suggestion-disabled-by-sibling")&&(e.removeAttribute("data-batched-suggestion-disabled-by-sibling"),e.setAttribute("disabled","disabled"),e.setAttribute("aria-label",document.querySelector(".js-one-suggestion-per-line").textContent))}for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none")}for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button")){let t=e.closest(".js-suggested-change-form-container"),n="true"===t.getAttribute("data-comment-pending"),r="true"===t.getAttribute("data-outdated-comment"),o="true"===t.getAttribute("data-resolved-comment"),s=e.closest(".js-inline-comments-container"),l=s.querySelector('input[name="side"]'),i="left"===l.value;n||r||o||i?e.classList.add("d-none"):e.classList.remove("d-none")}for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none")}}else{for(let t of(e.hidden=!0,document.querySelectorAll(".js-apply-single-suggestion")))t.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add"))e.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}}function ei(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>el(e))}function ea(e,t){let n=e.querySelector("input[name=commit_title]"),r=e.querySelector("textarea[name=commit_message]"),o=n.value.trim();""===o&&(o=n.defaultValue);let s=r.value.trim();""!==s&&(o=`${o}

${s}
`),n.disabled=!0,r.disabled=!0;let l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name","message"),l.value=o,e.appendChild(l);let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","changes"),i.value=JSON.stringify(t),e.appendChild(i)}(0,a.on)("click",".js-suggested-change-toolbar-item",function(e){let t=e.currentTarget;t instanceof HTMLButtonElement&&"false"===t.getAttribute("aria-disabled")&&ee(t)}),(0,a.on)("click",".js-refresh-after-suggestion",G.H5),(0,m.N7)(".js-inline-comments-container",{add(e){es(e)}}),(0,m.N7)(".js-preview-body .js-apply-changes",{add(e){let t=e.closest(".js-suggested-changes-container");if(!t)return e.remove();let n=document.querySelector(J.rightBlob).textContent,r=document.querySelector(J.leftBlob).textContent,o=e.closest(".js-suggested-changes-blob");if(""!==t.getAttribute("data-thread-side")){if("left"===t.getAttribute("data-thread-side"))return eo(r,o),e.remove()}else{let t=e.closest(".js-inline-comment-form"),n=t.querySelector('input[name="side"]');if(!t||!n)return e.remove();if(t&&"left"===n.value)return eo(r,o),e.remove()}let s=e.previousElementSibling,l=s.querySelector(".js-blob-code-deletion"),i=s.querySelectorAll(".js-blob-code-addition");if(!l||0===i.length)return;let a=l.textContent,c=Array.from(i).map(e=>e.textContent);if(a===c.join("\n"))return eo(n,o),e.remove();e.remove()}}),(0,m.N7)(".js-comment-body .js-apply-changes",{add(e){let t;let n=e.closest(".js-comment");if(!n)return e.remove();let r=n.querySelector(".js-suggested-changes-template");if(!(r instanceof HTMLTemplateElement))return e.remove();let o=r.content.cloneNode(!0),s=o.querySelector(".js-disabled-apply-suggestion-button");try{t=o.querySelector(".js-batched-suggested-changes-add")}catch(e){if("QueryError"!==e.name)throw e}if(document.querySelectorAll(".js-suggested-changes-files-tab").length){let e=document.querySelector(J.addToBatchEnabled).textContent;t&&(t.removeAttribute("disabled"),t.setAttribute("aria-label",e))}let l=document.querySelector(".js-pull-header-details"),i=l&&"true"===l.getAttribute("data-pull-is-open"),a=e.closest(".js-resolvable-timeline-thread-container"),c="true"===r.getAttribute("data-comment-pending"),d="true"===r.getAttribute("data-in-merge-queue"),u=n.classList.contains("js-selection-contains-deletions");if(a&&"true"===a.getAttribute("data-resolved")){let n=document.querySelector(J.resolvedThread).textContent,r=o.querySelector("details");return r&&r.remove(),er(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(!i){let n=document.querySelector(J.closedOrMergedPull).textContent;return er(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(d){let n=document.querySelector(J.inMergeQueue),r="";n&&(r=n.textContent||"");let l=o.querySelector("details");return l&&l.remove(),er(s,r),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",r)),e.replaceWith(o)}if(c){let n=document.querySelector(J.pendingReview).textContent;return o.querySelector("details").remove(),er(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(u){let n=document.querySelector(J.leftBlob).textContent;return o.querySelector("details").remove(),er(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}let f=document.querySelector(".js-suggested-changes-subset-files"),m="true"===r.getAttribute("data-outdated-comment");if(f||m){let n;return f?n=document.querySelector(J.viewingSubset).textContent:m&&(n=document.querySelector(J.outdatedComment).textContent),o.querySelector("details").remove(),er(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}let g=o.querySelector(".js-single-suggested-change-form"),h=e.closest(".js-suggested-changes-blob");if(h){let e=h.querySelectorAll(".js-blob-code-deletion"),n=h.querySelectorAll(".js-blob-code-addition");if(!e)return;let r=Array.from(e).map(e=>e.textContent),l=Array.from(n).map(e=>e.textContent),i=r.length===l.length&&r.every((e,t)=>e===l[t]);if(i){let e=document.querySelector(J.unchangedSuggestion).textContent;o.querySelector("details").remove(),er(s,e),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",e))}else for(let e of l){let t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","value[]"),t.value=e,g.appendChild(t)}}e.replaceWith(o)}}),(0,m.N7)(".js-pull-header-details",{add(e){let t="true"===e.getAttribute("data-pull-is-open"),n=document.querySelector(".js-suggested-changes-template");if(t||!(n instanceof HTMLTemplateElement))return;let r=n.content,o=document.querySelector(J.closedOrMergedPull).textContent;et(r,o),en(o)}}),(0,m.N7)(".js-suggested-changes-subset-files",{add(){let e=document.querySelector(".js-suggested-changes-template");if(!(e instanceof HTMLTemplateElement))return;let t=e.content,n=document.querySelector(J.viewingSubset).textContent;et(t,n),en(n)}}),(0,a.on)("click",".js-apply-suggestion-button",async function(e){let t=e.currentTarget.parentElement;if(t){let e=t.querySelector(".js-suggestion-commit-title");setTimeout(()=>e.focus(),1)}}),(0,a.on)("click",".js-dismiss-suggested-change-onboarding-notice",async function(e){let t=e.currentTarget.getAttribute("data-url"),n=e.currentTarget.parentElement.querySelector(".js-data-url-csrf"),r=new FormData;r.append("notice","suggested_changes_onboarding_prompt");let o=await fetch(t,{method:"POST",mode:"same-origin",body:r,headers:{"Scoped-CSRF-Token":n.value,"X-Requested-With":"XMLHttpRequest"}});if(o.ok){let e=document.querySelectorAll(".js-suggested-change-onboarding-notice");for(let t of e)t.remove()}}),(0,Y.w4)("keypress",".js-comment-field",function(e){if("Enter"===e.key){let t=e.target;K(t)&&e.preventDefault()}}),(0,Y.w4)("keypress",".js-suggestion-commit-message",function(e){let t=e.currentTarget;"Enter"===e.key&&t.setAttribute("rows","3")}),(0,a.on)("click",".js-batched-suggested-changes-add",function(e){let t=e.target,n=t.closest(".js-suggested-change-form-container");if("true"===n.getAttribute("data-comment-pending")||"true"===n.getAttribute("data-outdated-comment")||"true"===t.getAttribute("data-batched-suggestion-disabled-by-sibling"))return;n.setAttribute("data-pending-batched-suggestion","true");let r=t.closest(".js-inline-comments-container");for(let e of r.querySelectorAll(".js-batched-suggested-changes-add"))e.setAttribute("data-batched-suggestion-disabled-by-sibling","true");t.removeAttribute("data-batched-suggestion-disabled-by-sibling"),ei()}),(0,a.on)("click",".js-batched-suggested-changes-remove",function(e){let t=e.currentTarget.closest(".js-suggested-change-form-container");t.removeAttribute("data-pending-batched-suggestion");let n=e.currentTarget.closest(".js-inline-comments-container");for(let e of n.querySelectorAll(".js-batched-suggested-changes-add"))e.setAttribute("data-batched-suggestion-reenable-sibling","true");ei()}),(0,a.on)("click",".js-focus-commit-suggestions-form-button",function(e){e.preventDefault(),window.location.href="#clear-commit-suggestions",window.location.href="#commit-suggestions"}),(0,a.on)("click",".js-dismiss-batched-suggested-changes-onboarding-notice",async function(e){let t=e.currentTarget.getAttribute("data-url"),n=e.currentTarget.parentElement.querySelector(".js-data-url-csrf"),r=new FormData;r.append("notice","batched_suggested_changes_onboarding_prompt");let o=await fetch(t,{method:"POST",mode:"same-origin",body:r,headers:{"Scoped-CSRF-Token":n.value,"X-Requested-With":"XMLHttpRequest"}});if(o.ok)for(let e of document.querySelectorAll(".js-batched-suggested-change-onboarding-notice"))e.remove()}),(0,a.on)("click",".js-single-suggested-change-form .js-suggested-changes-submit",function(e){let t=e.currentTarget,n=t.closest(".js-single-suggested-change-form"),r=Array.from(n.querySelectorAll('input[name="value[]"]')).map(e=>e.value),o=[{commentId:n.querySelector("input[name=comment_id]").value,path:n.querySelector("input[name=path]").value,suggestion:r}];ea(n,o)}),(0,N.AC)(".js-single-suggested-change-form",async function(e,t){let n=e.closest(".js-suggested-change-form-container"),r=e.closest("details"),o=n.querySelector(".js-suggestion-applied"),s=e.closest(".js-suggested-changes-contents"),l=s.querySelector(".js-error-message-placeholder");try{await t.json(),o.classList.remove("d-none");let e=n.querySelector(".js-batched-suggested-changes-add");e.classList.add("d-none"),r.remove(),(0,G.H5)()}catch(t){if("QueryError"!==t.name){let o=t.response.json&&t.response.json.error,s=l.querySelector(".js-error-message");l.hidden=!1,s.textContent=o,n.prepend(l);let i=e.closest(".js-suggested-change-form-container"),a=i.querySelector(".js-batched-suggested-changes-add");a.classList.add("d-none"),r.remove()}}}),(0,a.on)("click",".js-suggestion-batch-submit",function(e){let t=e.currentTarget.closest(".js-batched-suggested-changes-form"),n=[];for(let e of document.querySelectorAll("[data-pending-batched-suggestion]")){let t=e.querySelector(".js-single-suggested-change-form"),r=Array.from(t.querySelectorAll('input[name="value[]"]')).map(e=>e.value);n.push({commentId:t.querySelector("input[name=comment_id]").value,path:t.querySelector("input[name=path]").value,suggestion:r})}ea(t,n)}),(0,N.AC)(".js-batched-suggested-changes-form",async function(e,t){try{await t.json();let n=e.closest(".js-batched-suggested-changes-container");n.hidden=!0,(0,G.H5)()}catch(s){let t=s.response.json&&s.response.json.error,n=e.closest(".js-batched-suggested-changes-container"),r=n.querySelector(".js-error-message-container"),o=r.querySelector(".js-error-message");o.textContent=t,r.hidden=!1}}),(0,m.N7)(".js-files-tab-stale",{add(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>{e.hidden=!0})}});let ec=0;function ed(e){let t=e.closest(".file-header"),n=ef(t,".diff-table");if(n instanceof Element){let e=n.querySelector(".js-inline-comments-container");if(e instanceof Element)return e}}function eu(e){let t=e.closest("tr"),n=ef(t,".js-inline-comments-container");if(n instanceof Element)return n}function ef(e,t){let n=e.nextElementSibling;return n&&n.matches(t)?n:null}function em(e){let t=e.closest("tr"),n=eC("js-inline-comments-single-container-template",e).firstElementChild;return t.after(n),n}function eg(e){let t=e.closest(".file-header"),n=document.createElement("table");n.className="diff-table";let r=eC("js-inline-comments-single-container-template",e).firstElementChild;return n.appendChild(r),t.after(n),r}function eh(e,t){let n=Array.from(e.querySelectorAll(".review-comment-form-container")).pop();if(n)return n.closest("div.js-line-comments");{let n=eC("js-inline-comments-single-container-template",t).querySelector("div.js-line-comments");return e.appendChild(n),n}}function ep(e){let t=e.querySelector(".js-comment-form-error");t&&(t.hidden=!0,t.textContent=null)}function eb(e,t){let n;let r=e.querySelector(".js-comment-form-error");n=t.errors?Array.isArray(t.errors)?t.errors.join(", "):t.errors:"There was an error posting your comment.",r.textContent=n,r.style.display="block",r.hidden=!1,r.classList.remove("d-none")}function ey(e){let[t,n]=e.match(/^new_inline_comment_(?:discussion|diff)_(?:[\w-]+)_(\d+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${n}']`);if(!r)return;let o=r.closest(".js-line-comments");o&&(0,I.j)(o)}function ej(e){let[t,n]=e.match(/^new_inline_comment_diff_(?:[\w-]+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-add-line-comment[data-anchor='${t}'][data-position='${n}']`);r&&r.click()}function ev(e){let t=e.querySelector(".js-toggle-file-notes");t instanceof HTMLInputElement&&(0,P.Se)(t,!0)}function eS(){for(let e of document.querySelectorAll(".file .js-inline-comments-container")){let t=e.querySelectorAll(".js-comments-holder > *"),n=t.length>0,r=null!=e.querySelector("[data-resolved='true']"),o=e.querySelector(".js-inline-comment-form-container"),s=!!o&&o.classList.contains("open");n||r||s||e.remove()}}function ew(e,t){let n=new URLSearchParams(e.search.slice(1)),r=t.elements.namedItem("in_reply_to")||t.elements.namedItem("comment_id"),o=t.querySelector("textarea");if(n.append("textarea_id",o.id),r instanceof HTMLInputElement&&r.value)return n.append("comment_id",r.value),n;let s=t.elements.namedItem("path"),l=t.elements.namedItem("start_side"),i=t.elements.namedItem("start_line"),a=t.elements.namedItem("side"),c=t.elements.namedItem("line"),d=t.elements.namedItem("start_commit_oid"),u=t.elements.namedItem("end_commit_oid"),f=t.elements.namedItem("base_commit_oid"),m=t.elements.namedItem("subject_type");return s instanceof HTMLInputElement&&l instanceof HTMLInputElement&&i instanceof HTMLInputElement&&a instanceof HTMLInputElement&&c instanceof HTMLInputElement&&d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&f instanceof HTMLInputElement&&m instanceof HTMLInputElement?(n.append("path",s.value),n.append("start_side",l.value),n.append("start_line",i.value),n.append("end_side",a.value),n.append("end_line",c.value),n.append("start_commit_oid",d.value),n.append("end_commit_oid",u.value),n.append("base_commit_oid",f.value),n.append("subject_type",m.value),n):null}async function eA(e){let t;let n=e.querySelector(".js-suggestion-button-placeholder");if(!n)return;let r=n.getAttribute("data-src-base");if(!r)return;let o=new URL(r,window.location.origin),s=n.closest(".js-inline-comment-form")||n.closest(".js-comment-update");if(!(s instanceof HTMLFormElement))return;let l=ew(o,s);if(l){o.search=l.toString();try{t=await (0,$.a_)(document,o.toString())}catch{return}n.textContent="",n.appendChild(t)}}function eq(e,t,n){let r=e.querySelector(`.js-line-comments.${t}`);if(r)return r;let o=eC("js-inline-comments-split-form-container-template",n).firstElementChild;o.classList.add(t);let s=e.querySelectorAll(`.${t}`),l=s[s.length-1];for(let e of(l.after(o),s))e.remove();return o}function eL(e){let t=ef(e,".js-inline-comments-container");if(t)return t;{let n="js-inline-comments-split-container-template",r=document.getElementById(n);if(!r)throw Error(`Could not find element with id ${n}`);if(!(r instanceof HTMLTemplateElement))throw Error(`Found element with id ${n} - but was not a Template`);return t=new F.R(r,{}).firstElementChild,e.after(t),t}}function eE(e,t,n,r){if(e.classList.remove("color-bg-success","color-bg-danger"),r){e.textContent=t;return}if("right"===n){e.classList.add("color-fg-success"),e.textContent=`+${t}`;return}if("left"===n){e.classList.add("color-fg-danger"),e.textContent=`-${t}`;return}e.textContent=String(t)}(0,a.on)("click",".js-add-file-comment",function(e){let t=e.currentTarget,n=t.closest(".file");ev(n);let r=ed(t)||eg(t),o=eh(r.querySelector("td"),t),s=o.querySelector(".js-inline-comment-form");if(s instanceof HTMLFormElement){let e=s.getElementsByClassName("js-suggestion-button-placeholder")[0];e.style.display="none",ex(s,t)}(0,I.j)(o)}),(0,a.on)("click",".js-add-single-line-comment",function(e){let t=e.currentTarget,n=t.closest(".file");ev(n);let r=eu(t)||em(t),o=eh(r.querySelector("td"),t),s=o.querySelector(".js-inline-comment-form");s instanceof HTMLFormElement&&ex(s,t),(0,I.j)(o)}),(0,a.on)("click",".js-add-split-line-comment",function(e){let t=e.currentTarget,n=t.closest(".file");ev(n);let r=t.closest("tr"),o="addition"===t.getAttribute("data-type")?"js-addition":"js-deletion",s=eL(r),l=eq(s,o,t),i=eh(l,t),a=i.querySelector(".js-inline-comment-form");a instanceof HTMLFormElement&&ex(a,t),(0,I.j)(i)}),(0,N.AC)(".js-inline-comment-form",async function(e,t){let n;ep(e);try{n=await t.json()}catch(t){if(t.response){let n;try{n=t.response.json}catch{}if(n){eb(e,n);return}}throw t}let r=n.json,o=r.inline_comment,s=e.closest(".js-line-comments");o&&s.querySelector(".js-comments-holder").append((0,D.r)(document,o));let l=r.inline_comment_thread;l&&s.replaceWith((0,D.r)(document,l)),(0,I.w)(e)}),document.addEventListener("session:resume",function(e){let t=e.detail;ey(t.targetId),ej(t.targetId)}),(0,m.N7)(".js-comment",{remove:eS}),(0,a.on)("inlinecomment:focus",".js-inline-comment-form-container",function(e){let t=e.target.querySelector(".js-suggested-changes-container");t&&eA(t)}),(0,m.N7)(".js-suggested-changes-container.is-comment-editing",e=>{eA(e)}),document.addEventListener("inlinecomment:collapse",()=>{eS()});let eT={R:"right",L:"left"};function e_(e,t){let n=(0,H.vu)();if(!n||n.end.is(n.start))return;if(!(0,H.Oz)(t,n)){(0,H.MO)();return}let{start:{lineNumber:r},end:{lineNumber:o}}=n,{start:{side:s},end:{side:l}}=n,i=Number(t.getAttribute("data-line")),a=t.getAttribute("data-side");if(i!==o||!n.end.isContext()&&a!==eT[l]){(0,H.MO)();return}let c=eT[s],d=e.elements.namedItem("start_line"),u=e.elements.namedItem("start_side"),f=e.elements.namedItem("line"),m=e.elements.namedItem("side"),g=e.elements.namedItem("preview_start_side"),h=e.elements.namedItem("preview_side");if(d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&f instanceof HTMLInputElement&&m instanceof HTMLInputElement&&g instanceof HTMLInputElement&&h instanceof HTMLInputElement){d.value=String(r),u.value=c,u.value=g.value=u.value,h.value=m.value;let t=d.value;s=u.value;let o=f.value;l=m.value;let i=e.closest(".js-inline-comment-form-container");if(t&&o){let e=i.querySelector(".js-multi-line-preview"),r=e.querySelector(".js-multi-line-preview-start"),a=e.querySelector(".js-multi-line-preview-end"),c=n.start.isContext(),d=n.end.isContext();eE(r,t,s,c),eE(a,o,l,d),e.hidden=!1,i.classList.add("is-multiline")}else i.querySelector(".js-multi-line-preview").hidden=!0,i.classList.remove("is-multiline");es(i)}}function ex(e,t){for(let n of["type","path","position","line","side","original-line"]){let r=e.elements.namedItem(n);if(r instanceof HTMLInputElement){let e=t.getAttribute(`data-${n}`)||"";r.value=e}}let n=e.elements.namedItem("subject_type");if(n instanceof HTMLInputElement){let e=t.getAttribute("data-subject-type")||"";n.value=e}let r=e.getElementsByClassName("js-expanded-diff-placeholder-value")?.[0];if(r instanceof HTMLInputElement){let e=t.getAttribute("data-expanded-diff")||"";r.value=e}e_(e,t)}function eC(e,t){let n=document.getElementById(e);if(!n)throw Error(`Could not find element with id ${e}`);if(!(n instanceof HTMLTemplateElement))throw Error(`Found element with id ${e} - but was not a Template`);return new F.R(n,{anchor:t.getAttribute("data-anchor")||"",position:t.getAttribute("data-position")||"",subject_type:t.getAttribute("data-subject-type")||"",sequence:ec++})}var ek=n(70763),eM=n(87098),eR=n(52191),eI=n(15345);function eH(e,t){let n=e.querySelectorAll(".js-comment-container");for(let e of n){let n=e.getAttribute("data-hidden-comment-ids");if(n){let r=n.split(","),o=t.match(/\d+/g)?.[0];if(o&&r.includes(o)){(0,eR.$)(e);break}}}}function eF(e){let t=eP();if(!t)return;e$(e,t);let n=eD(e,t);n&&((0,c.zT)(n),eB(n))}function eP(){return window.location.hash.slice(1)}function e$(e,t){let n;(n=t.match(/^diff-.+[LR]\d+-[LR]\d+/)?(0,eM.Q)(e.ownerDocument,t.substring(0,t.indexOf("-",5))):(0,eM.Q)(e.ownerDocument,t))&&e.contains(n)?((0,ek.O4)(n),(0,c.zT)(n)):eH(e,t)}function eD(e,t){let n=eN(e,t);return n||eO(e,t)}function eN(e,t){let n=/^(diff-[0-9a-f]{32})(?:[L|R]\d+)?$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`a[name='${r}']`);if(!o)return;let s=o.nextElementSibling;if(!s||s.querySelector(".js-diff-load-container"))return s}function eO(e,t){let n=/^(?:r|commitcomment-)(\d+)$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`#diff-with-comment-${r}`);if(!o)return;let s=o.closest(".js-file");return s}function eB(e){let t=e.querySelector(".js-diff-entry-loader"),n=e.querySelector(".js-diff-placeholder"),r=e.querySelector("button.js-diff-load"),o=e.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0;let s=new URL(t.getAttribute("data-fragment-url")||"",window.location.origin);return t.src=s.toString(),t.data}(0,m.N7)(".js-diff-progressive-container",function(e){eF(e);let t=e.querySelector(".js-diff-progressive-loader");t&&t.addEventListener("load",function(){eF(e)})}),(0,m.N7)(".js-diff-load-container",function(e){let t=e.querySelector(".js-diff-entry-loader");t&&t.addEventListener("load",function(){let t=e.closest(".js-file");t.classList.remove("hide-file-notes-toggle"),(0,eI.N)(e);let n=eP();n&&e$(e,n)})}),(0,a.on)("click",".js-diff-load",function(e){if(e.target.classList.contains("js-ignore-this"))return;let t=e.currentTarget.closest(".js-diff-load-container");eB(t),t?.focus(),(0,eI.x)("Loading...")});var eW=n(9302);function eU(e){let t=e.closest(".js-file-header"),n=e.classList.contains("js-rendered"),r=e.classList.contains("js-source"),o=t.getAttribute("data-short-path"),s=t.getAttribute("data-anchor"),l=new URL(window.location.href,window.location.origin),i=new URLSearchParams(l.search.slice(1));l.hash=s,n?i.set("short_path",o):r&&i.delete("short_path"),l.search=i.toString(),(0,eW.lO)(null,"",l.toString())}function ez(e){for(let e of document.querySelectorAll(".js-rendered, .js-source"))e.classList.remove("selected"),e.removeAttribute("aria-current");e.classList.add("selected"),e.setAttribute("aria-current","true")}(0,a.on)("click",".js-rendered, .js-source",function(e){let t=e.currentTarget;if(t.classList.contains("selected")){e.preventDefault();return}eU(t),ez(t)}),(0,N.AC)(".js-prose-diff-toggle-form",async function(e,t){let n=e.closest(".js-details-container"),r=n.querySelector(".js-file-content"),o=await t.html();for(;r.lastChild;)r.removeChild(r.lastChild);r.append(o.html),n.classList.toggle("display-rich-diff")}),(0,a.on)("click",".js-toc-retry",function(e){if(!(e.target instanceof Element))return;let t=e.target.closest(".select-menu"),n=t.querySelector("include-fragment"),r=n.getAttribute("src");n.setAttribute("src",""),n.setAttribute("src",r)});var eQ=n(75198);function eX(e,t,n){let r=Array.from(e.querySelectorAll('[role="menuitem"]')),o=r.indexOf(t),s=r.indexOf(n);if(-1===o)throw Error("Couldn't find startIndex in container");if(-1===s)throw Error("Couldn't find endItem in container");for(let t of(eK(e),r[s].classList.add("is-last-in-range"),o>s&&([o,s]=[s,o]),r.slice(o,s+1)))t.classList.add("is-range-selected")}async function eZ(e,t){function n(n){eX(e,t,n.target.closest('[role="menuitem"]'))}eX(e,t,t),e.addEventListener("mouseover",n),await new Promise(e=>window.addEventListener("keyup",e,{once:!0})),e.removeEventListener("mouseover",n),eK(e)}function eK(e){for(let t of e.querySelectorAll('[role="menuitem"]'))t.classList.remove("is-range-selected","is-last-in-range")}function eV(e){let t=e.closest("details-menu"),n=!1;function r(e){(n=e.shiftKey)&&e.preventDefault()}function o(t){if(!n)return;t.preventDefault();let r=t.detail.relatedTarget;if(r.classList.contains("is-range-selected")){t.stopPropagation();let n=e.querySelectorAll(".is-range-selected"),r=n[0],o=n[n.length-1],s=e.getAttribute("data-range-url"),l=r.getAttribute("data-parent-commit"),i=o.getAttribute("data-commit"),a=l&&i?`${l}..${i}`:i,c=s.replace("$range",a);(0,eQ.softNavigate)(c)}else t.stopImmediatePropagation(),eZ(e,r)}return e.addEventListener("click",r,{capture:!0}),t.addEventListener("details-menu-select",o),{unsubscribe:()=>{e.removeEventListener("click",r,{capture:!0}),t.removeEventListener("details-menu-select",o)}}}(0,m.N7)(".js-diffbar-range-menu .js-diffbar-range-list",{subscribe:eV}),(0,a.on)("toggle",".js-diffbar-range-menu",function(e){let t=e.currentTarget;if(!t.hasAttribute("open"))return;let n=t.querySelector(".in-range");n&&n.focus()},{capture:!0});var eY=n(97629);(0,a.on)("click",".js-compare-tab",function(e){for(let e of document.querySelectorAll(".js-compare-tab.selected"))e.classList.remove("selected");for(let t of(e.currentTarget.classList.add("selected"),document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket")))t.classList.add("d-none");let t=e.currentTarget,n=t.hash;document.querySelector(n).classList.remove("d-none"),e.preventDefault()}),(0,f.Z)(function({target:e}){if(!(e instanceof HTMLElement))return;let t=e.closest("#commits_bucket, #files_bucket, #commit_comments_bucket");t&&t instanceof HTMLElement&&!(0,eY.Z)(t)&&document.querySelector(`.js-compare-tab[href="#${t.id}"]`).click()}),(0,a.on)("click",".js-toggle-range-editor-cross-repo",function(){document.querySelector(".js-range-editor").classList.toggle("is-cross-repo")}),(0,m.N7)(".js-compare-pr.open",{add(){document.body.classList.add("is-pr-composer-expanded")},remove(){document.body.classList.remove("is-pr-composer-expanded")}}),(0,a.on)("change",".js-collab-checkbox",function({currentTarget:e}){let t=e.form;for(let e of t.querySelectorAll(".errored"))e.classList.remove("errored");let n=e.closest(".js-collab-option"),r=n.querySelector(".js-status-indicator");r.classList.remove("status-indicator-success","status-indicator-failed"),r.classList.add("status-indicator-loading")}),(0,N.AC)(".js-collab-form",async function(e,t){try{await t.text()}catch(t){for(let t of e.querySelectorAll(".status-indicator-loading")){t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-failed");let e=t.closest(".js-collab-option");e.classList.add("errored");let n=e.querySelector(".js-collab-checkbox");n.checked=!n.checked}for(let t of e.querySelectorAll(".status-indicator-success"))t.classList.remove("status-indicator-success");return}for(let t of e.querySelectorAll(".errored"))t.classList.remove("errored");for(let t of e.querySelectorAll(".status-indicator-loading"))t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-success")});var eG=n(76006),eJ=n(3447);function e0(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function e1(e,t){return t.get?t.get.call(e):t.value}function e7(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}function e3(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function e4(e,t){var n=e3(e,t,"get");return e1(e,n)}function e5(e,t,n){e0(e,t),t.set(e,n)}function e2(e,t,n){var r=e3(e,t,"set");return e7(e,r,n),n}var e6=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l};let e9=(r=new WeakMap,o=new WeakMap,s=new WeakMap,l=new WeakMap,(i=class DiffLayoutElement extends HTMLElement{connectedCallback(){if(!this.sidebarContainer)return;e2(this,l,new MutationObserver(this.handleNotificationShelfMutation)),e4(this,l).observe(document.body,{subtree:!0,childList:!0});let{signal:e}=e2(this,s,new AbortController);window.addEventListener("scroll",this.handleSidebarScroll,{signal:e}),window.addEventListener("resize",()=>this.handleSidebarResize(),{signal:e}),this.handleSidebarScroll()}disconnectedCallback(){this.sidebarContainer&&(e4(this,l).disconnect(),e4(this,s)?.abort(),null!=e4(this,r)&&cancelAnimationFrame(e4(this,r)),null!=e4(this,o)&&cancelAnimationFrame(e4(this,o)))}toggleSidebar(e){if(this.layoutContainer.classList.toggle("hx_Layout--sidebar-hidden"),this.sidebarHidden=!this.sidebarHidden,!this.fileTree)return;let t=e.detail.toggleButton;t&&(this.fileTree.instrumentToggleFileTree(t),this.fileTreePathFilter&&"show-file-tree-button"===t.id&&this.fileTreePathFilter.focus())}handleOpenFilesListHotkeyEvent(){if(this.shouldOpenTocMenu()){this.tocMenuButton.click();return}this.fileTree&&(this.showFileTreeButton&&this.sidebarHidden?this.showFileTreeButton.click():this.fileTreePathFilter&&!this.sidebarHidden&&this.fileTreePathFilter.focus())}shouldOpenTocMenu(){return!!(this.tocMenu&&!this.tocMenu.hasAttribute("open")&&"none"!==window.getComputedStyle(this.tocMenu).display)}handleNotificationShelfMutation(e){let t=document.firstElementChild;if(t.classList.contains("js-skip-scroll-target-into-view"))for(let n of e){for(let e of n.addedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.add("has-notification-top-shelf");break}for(let e of n.removedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.remove("has-notification-top-shelf");break}}}handleSidebarResize(){e2(this,o,requestAnimationFrame(this.updateSidebarHeight))}constructor(...e){super(...e),e5(this,r,{writable:!0,value:null}),e5(this,o,{writable:!0,value:null}),e5(this,s,{writable:!0,value:void 0}),e5(this,l,{writable:!0,value:void 0}),this.handleSidebarScroll=()=>{e2(this,r,requestAnimationFrame(this.updateSidebarHeight))},this.updateSidebarHeight=()=>{let e;if(!this.sidebarContainer)return;let t=document.documentElement.clientHeight,n=this.diffToolbar.getBoundingClientRect(),r=this.mainContainer.getBoundingClientRect(),o=t>=r.bottom,s=0===n.top;o?(e=r.bottom-parseInt(this.sidebarContainer.style.top),e=Math.min(r.height,e)):e=s?t-n.height:t-this.sidebarContainer.getBoundingClientRect().top,this.sidebarContainer.style.height=`${e}px`},this.sidebarHidden=!1}}).attrPrefix="",i);e6([eG.Lj],e9.prototype,"sidebarHidden",void 0),e6([eG.fA],e9.prototype,"layoutContainer",void 0),e6([eG.fA],e9.prototype,"diffToolbar",void 0),e6([eG.fA],e9.prototype,"tocMenu",void 0),e6([eG.fA],e9.prototype,"tocMenuButton",void 0),e6([eG.fA],e9.prototype,"mainContainer",void 0),e6([eG.fA],e9.prototype,"sidebarContainer",void 0),e6([eG.fA],e9.prototype,"fileTree",void 0),e6([eG.fA],e9.prototype,"showFileTreeButton",void 0),e6([eG.fA],e9.prototype,"fileTreePathFilter",void 0),e6([(0,eJ.D)(100)],e9.prototype,"handleSidebarResize",null),e9=e6([eG.Ih],e9),(0,a.on)("click",".js-split-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.add("color-border-accent-emphasis"),t.classList.remove("color-border-default"),e.classList.remove("color-border-accent-emphasis"),e.classList.add("color-border-default"),r.checked=!1,n.checked=!0}),(0,a.on)("click",".js-unified-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.remove("color-border-accent-emphasis"),t.classList.add("color-border-default"),e.classList.add("color-border-accent-emphasis"),e.classList.remove("color-border-default"),r.checked=!0,n.checked=!1});var e8=n(11793),te=n(29764);let tt=class InstrumentFilesElement extends HTMLElement{connectedCallback(){document.addEventListener("keydown",this.instrumentCtrlF)}disconnectedCallback(){document.removeEventListener("keydown",this.instrumentCtrlF)}constructor(...e){super(...e),this.instrumentCtrlF=e=>{let t=["Control+f","Meta+f"],n=(0,e8.EL)(e);t.includes(n)&&(0,te.sz)(this)}}};tt=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}([eG.Ih],tt);var tn=n(27034),tr=n(5582);function to(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr");n.classList.toggle("is-updating-via-merge","merge"===t.value),n.classList.toggle("is-updating-via-rebase","rebase"===t.value);let r=n.querySelector(".js-update-branch-type");r&&(r.value=t.value)}function ts(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr"),r=n.querySelector(".js-merge-pull-request"),o=n.querySelector(".js-merge-method-menu-button"),s=o.getAttribute("data-merge-button-class");o.classList.toggle("btn-danger",t.hasAttribute("data-dangerous-action")),s&&o.classList.toggle(s,!t.hasAttribute("data-dangerous-action"));let l=n.querySelectorAll(".js-merge-title"),i=n.querySelectorAll(".js-merge-message");for(let e of l)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-title-value"));for(let e of i)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-message-value"));n.classList.toggle("is-merging","merge"===t.value),n.classList.toggle("is-squashing","squash"===t.value),n.classList.toggle("is-rebasing","rebase"===t.value),n.classList.toggle("is-merging-group","group"===t.value),n.classList.toggle("is-merging-solo","solo"===t.value),n.classList.toggle("is-merging-jump","jump"===t.value);let a=r.classList.contains("js-admin-override-merge")&&"merge"===t.value||r.classList.contains("js-admin-override-squash")&&"squash"===t.value||r.classList.contains("js-admin-override-rebase")&&"rebase"===t.value,c=n.querySelector(".js-merge-type");c&&(c.value=t.value);let d=n.querySelectorAll(".js-merge-pull-request .js-merge-commit-button,.js-confirm-auto-merge-button");for(let e of d)t.value===e.value?(e.type="submit",e.classList.contains("js-confirm-auto-merge-button")&&(0,tr.j)(e)):e.type="button";r.classList.toggle("color-fg-danger",a);let u=n.closest(".js-pull-merging"),f=new URL(u.getAttribute("data-url"),window.location.origin),m=new URLSearchParams(f.search);m.set("merge_type",t.value),f.search=m.toString(),u.setAttribute("data-url",f.toString())}(0,a.on)("details:toggled",".js-pull-merging",function({currentTarget:e}){let t=Array.from(e.querySelectorAll(".js-merge-pull-request")),n=t.some(eY.Z);for(let e of t)e.classList.toggle("is-dirty",n)}),(0,a.on)("click",".js-merge-box-try-again",async function({currentTarget:e}){let t=e.getAttribute("data-form-target");if(!["js-cleanup-branch-form","js-merge-branch-form","js-queue-branch-form","js-update-branch-form"].includes(t))return;let n=e.closest(".js-pull-merging").getElementsByClassName(t)[0];(0,a.f)(n,"submit")}),document.addEventListener("session:resume",function(e){let t=document.getElementById(e.detail.targetId);if(t){let e=t.closest(".js-merge-pull-request");if(e){let t=e.closest(".js-details-container");t&&t.classList.add("open")}}}),(0,a.on)("change",".js-admin-merge-override",function({currentTarget:e}){let t=e.closest(".js-merge-message-container"),n=e.checked,r=t.querySelector(".js-merge-box"),o=t.querySelector(".js-auto-merge-box"),s=t.querySelector(".js-merge-form"),l=t.querySelector(".js-auto-merge-form"),i=t.querySelector(".js-queue-branch-form"),a=t.querySelectorAll(".merge-box-button");for(let e of(r&&(r.hidden=!n),o&&(o.hidden=n),s&&(s.hidden=!n),l&&(l.hidden=n),i&&(i.hidden=n),a))e.disabled=!n}),(0,a.on)("details-menu-selected",".js-update-branch-method-menu",to,{capture:!0}),(0,a.on)("submit",".js-update-branch-form",function({currentTarget:e}){let t=e.closest(".js-merge-pr"),n=t?.querySelector(".btn-group-update-merge");n&&(n.disabled=!0);let r=t?.querySelector(".btn-group-update-rebase");r&&(r.disabled=!0);let o=t?.querySelector(".js-update-method-menu-button");o&&(o.classList.add("disabled","user-select-none"),o.setAttribute("aria-disabled","true"));let s=t?.querySelector(".js-update-branch-method-menu");s&&s?.parentNode?.removeChild(s)}),(0,a.on)("details-menu-selected",".js-merge-method-menu",ts,{capture:!0}),(0,a.on)("details:toggled",".js-merge-pr",function(e){let t=e.currentTarget,n=t.querySelector(".js-merge-message");n&&(0,a.f)(n,"change")}),(0,m.N7)(".branch-action-item.js-details-container.open",{add(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.setAttribute("open","")},remove(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.removeAttribute("open")}}),(0,a.on)("toggle",".js-details-container .js-merge-review-section",function({currentTarget:e}){let t=e.closest(".js-details-container"),n=t.querySelectorAll(".js-merge-review-section").length,r=t.querySelectorAll(".js-merge-review-section[open]").length;0===r?(0,ek.Qp)(t,{force:!1}):r===n&&(0,ek.Qp)(t,{force:!0})},{capture:!0}),(0,m.N7)("poll-include-fragment[data-to-be-polled]",{constructor:tn.Z,add(e){function t(){e.src=e.getAttribute("data-to-be-polled"),e.removeAttribute("data-to-be-polled")}document.hidden?document.addEventListener("visibilitychange",t,{once:!0}):t()}}),(0,a.on)("submit",".js-remove-from-queue-form",async e=>{let t=e.currentTarget;e.preventDefault();let n=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});n&&n.ok||(window.onbeforeunload=()=>{window.scrollTo({top:0})},window.location.reload())});var tl=n(96776);let ti=!1;function ta(){let e=document.querySelectorAll(".pull-request-ref-restore");for(let t=0;t<e.length;t++)e[t].classList.toggle("last",t===e.length-1)}function tc(){let e=null!=document.querySelector("#js-pull-restorable"),t=document.querySelector(".js-pull-discussion-timeline");t&&t.classList.toggle("is-pull-restorable",e)}document.addEventListener("keydown",function(e){"Alt"===e.key&&(ti=!0)}),document.addEventListener("keyup",function(e){"Alt"===e.key&&(ti=!1)}),(0,a.on)("click",".js-toggle-outdated-comments",function(e){if(!(e instanceof MouseEvent&&e.altKey||ti)||!(e.currentTarget instanceof HTMLElement))return;let t=e.currentTarget,n=t.closest("details");function r(){let e=n.hasAttribute("open");for(let n of document.querySelectorAll(".js-toggle-outdated-comments"))if(n!==t){let t=n.closest("details");t.toggleAttribute("open",e)}}setTimeout(()=>{(0,tl.uQ)(t,r)})}),(0,m.N7)(".pull-request-ref-restore",{add:ta,remove:ta}),(0,m.N7)("#js-pull-restorable",{add:tc,remove:tc});var td=n(54679);function tu(e,t){let n=e.closest(".js-review-state-classes"),r=document.querySelector(".js-review-changes");for(let e of(n.classList.toggle("is-review-pending",t>0),document.querySelectorAll(".js-pending-review-comment-count")))e.textContent=String(t);for(let e of document.querySelectorAll(".js-pending-comment-count-type"))e instanceof HTMLElement&&(e.textContent=e.getAttribute(1===t?"data-singular-string":"data-plural-string"));if(t>0){r.textContent=r.getAttribute("data-pending-message")||"";let t=e.querySelector(".js-reviews-toggle");t.classList.add("anim-pulse-in"),t.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0})}else r.textContent=r.getAttribute("data-message")||""}function tf(e){let t=document.querySelector(".js-reviews-container");t&&setTimeout(()=>tu(t,e))}function tm(e){return e.getAttribute("ratio").split("/")}function tg(e){if(e){let[t,n]=tm(e),r=parseInt(t)/parseInt(n),o=e.querySelector(".js-review-progress"),s=e.querySelector(".js-review-count");o instanceof HTMLElement&&s&&(o.style.width=`${100*r}%`,s.textContent=`${t} / ${n}`)}}(0,N.AC)(".js-inline-comment-form",async function(e,t){let n=await t.text();tf(n.json.pendingReviewCommentsCount)}),(0,N.AC)(".js-pending-review-comment .js-comment-delete",async function(e,t){let n=await t.text();tf(n.json.pendingReviewCommentsCount)}),(0,N.AC)(".js-resolvable-timeline-thread-form",async function(e,t){try{let n=await t.html(),r=e.closest(".js-resolvable-timeline-thread-container");r.replaceWith(n.html)}catch(e){(0,td.v)()}}),(0,N.AC)(".js-toggle-user-reviewed-file-form",async function(e,t){let n=e.closest(".js-details-container"),r=!!n.querySelector(".js-reviewed-file"),o=n.querySelector(".js-file-level-comments-table"),s=n.classList.contains("open"),l=n.querySelector(".js-file-header"),i=!!l&&60===l.getBoundingClientRect().top;(!r&&s||r&&!s)&&((0,ek.Qp)(n),o&&o.classList.toggle("hidden"),i&&(0,c.zT)(n));let a=e.querySelector(".js-reviewed-toggle");r?(a.classList.remove("color-bg-accent","color-border-accent"),a.classList.add("color-fg-muted","color-border-default")):(a.classList.remove("color-fg-muted","color-border-default"),a.classList.add("color-bg-accent","color-border-accent"));let d=a.querySelector(".js-reviewed-checkbox");d.disabled=!0;let u=document.querySelector("progress-bar");u instanceof th&&(r?u.decrement():u.increment());let f=document.getElementById(`file-tree-item-${n.id}`);f&&f.toggleAttribute("data-file-user-viewed");try{let r=await t.html(),o=e.closest(".js-replace-file-header-review");o&&(o.replaceWith(r.html),n.toggleAttribute("data-file-user-viewed"))}catch(t){let e=document.querySelector("template.js-flash-template");e.after(new F.R(e,{className:"flash-error",message:"There was an error marking the file as viewed."})),d.checked=!1,d.disabled=!1}});let th=class ProgressBarElement extends HTMLElement{static get observedAttributes(){return["ratio"]}attributeChangedCallback(e){"ratio"===e&&tg(this)}connectedCallback(){tg(this)}increment(){let[e,t]=tm(this),n=Math.min(parseInt(e)+1,parseInt(t));this.setAttribute("ratio",`${n}/${t}`)}decrement(){let[e,t]=tm(this),n=Math.min(parseInt(e)-1,parseInt(t));n=Math.max(n,0),this.setAttribute("ratio",`${n}/${t}`)}};window.customElements.get("progress-bar")||(window.ProgressBarElement=th,window.customElements.define("progress-bar",th));var tp=n(4412),tb=n(68202),ty=n(40458);function tj(){for(let e of document.querySelectorAll(".js-pull-refresh-on-pjax"))(0,G.x0)(e)}function tv(e,t="flash-error"){let n=document.querySelector("template.js-flash-template");n.after(new F.R(n,{className:t,message:e}))}document.addEventListener(tb.QE.SUCCESS,tj),(0,a.on)("click",".js-change-base-form-button",async function(e){e.preventDefault();let t=e.currentTarget,n=t.querySelector(".js-change-base-spinner");t.disabled=!0,n.style.display="inline",await (0,ty.Z)();try{let e=t.form,n=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),r=await n.json();if((0,ek.Qp)(document.querySelector(".js-pull-header-details"),{force:!1}),!n.ok){tv(r.error_message);return}let o=await (await (0,$.DF)(r.job.url,{headers:{accept:"application/json"}})).json();o.job.error_message?tv(o.job.error_message):tv("The base branch was changed successfully.","flash-notice")}catch(e){tv("An unknown error occured.")}finally{let t=e.target.closest("details");t.removeAttribute("open")}}),(0,m.N7)(".js-updating-pull-request-commits-count",{add(e){let t=e.textContent,n=document.querySelectorAll(".js-updateable-pull-request-commits-count");for(let e of n)e.textContent=t}}),(async()=>{if(await tp.x,window.performance&&window.performance.navigation&&window.performance.navigation.type===window.performance.navigation.TYPE_RELOAD){let e=document.getElementById("js-report-pull-request-refresh");e&&(0,te.Fk)(e)}})();var tS=n(37574),tw=n(75297);function tA(e){let t=e.querySelector(".js-diff-entry-loader"),n=e.querySelector(".js-diff-placeholder"),r=e.querySelector("button.js-diff-load"),o=e.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0;let s=new URL(t.getAttribute("data-fragment-url")||"",window.location.origin);return t.src=s.toString(),t.data}function tq(e){(0,ek.O4)(e),(0,c.zT)(e)}function tL(e){if(!e)return;let t=(0,tS.s)(e);if(!t)return;let n=t[1],r=t[2],o=t[3],s=t[5];return{anchor:n,side:r,line:o,lastLine:s,hashFragment:n+r+o,partialHashFragment:n+r}}async function tE(e,t){let{anchor:n,side:r,line:o,lastLine:s,hashFragment:l,partialHashFragment:i}=e,a=(0,eM.Q)(document,n);if(!a)return;let c=tC(a,r,o,s);if(!c.length){let e=(0,eM.Q)(document,l);if(e){tq(e);return}let t=a.querySelector(".js-diff-load-container");if(!t)return;try{await tA(t);let e=(0,eM.Q)(document,l);e instanceof HTMLElement&&tq(e)}catch(e){tq(a)}return}await tT(c,i);let d=(0,eM.Q)(document,l),u=tC(a,r,o,s);u.length?tE(e,t):d?tq(d):t<1&&tE(e,t+1)}function tT(e,t){return Promise.all(e.map(e=>t_(e,t)))}async function t_(e,t){let n;if(t){let r="R"===t.slice(-1)?"data-right-range":"data-left-range",o=e.getAttribute(r)||"",s=parseInt(o.split("-")[0],10);n=t+s}else n=e.hash.slice(1);let r=e.getAttribute("data-url"),o=new URL(r,window.location.origin),s=new URLSearchParams(o.search.slice(1));s.append("anchor",n),o.search=s.toString();let l=await (0,$.a_)(document,o.toString()),i=e.closest(".js-file");if(!i)return;let c=e.closest(".js-expandable-line"),d=tx(c,".file-diff-line");d?(0,tl.uQ)(d,()=>{c.replaceWith(l)}):c.replaceWith(l),(0,a.f)(i,"expander:expanded"),tk(i)}function tx(e,t){let n=e.nextElementSibling;return n instanceof HTMLElement&&n.matches(t)?n:null}function tC(e,t,n,r){let o=parseInt(n,10),s=parseInt(r||"",10);return Array.from(e.querySelectorAll(".js-expand")).filter(e=>{let n=(e.getAttribute("R"===t?"data-right-range":"data-left-range")||"").split("-"),r=parseInt(n[0],10),l=parseInt(n[1],10);return!!(r<=o)&&!!(o<=l)||!!(o<=r)&&!!(l<=s)||!!(r<=s)&&!!(s<=l)})}function tk(e){let t=e.querySelector(".js-expand-full-wrapper");if(!t)return;let n=Array.from(e.querySelectorAll(".js-expand"));0===n.length&&t.parentElement.removeChild(t)}async function tM(e,t){let n=await self.fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok)throw Error(`Request to blob_expand failed with status code ${n.status}`);let r=await n.json();return r.map(t=>({...t,content:(0,D.r)(e,t.content)}))}function tR(e,t){return!!(e instanceof HTMLElement&&(0,tw.ur)(e))&&t(e)}function tI(e,t){let n=new URL(e.getAttribute("data-url"),window.location.origin),r=n.searchParams;return{position:t.toString(),left:{start:r.get("last_left"),end:r.get("left"),size:r.get("left_hunk_size")},right:{start:r.get("last_right"),end:r.get("right"),size:r.get("right_hunk_size")}}}function tH(e){let t=Array.from(e.querySelectorAll(".js-expand")),n=t.map((e,t)=>tI(e,t)),r=!1,o=[];for(let e=0;e<n.length;e++){if(r){r=!1;continue}let t=n[e],s=n[e+1];r=!!s&&t.left.start===s.left.start&&t.left.end===s.left.end&&t.right.start===s.right.start&&t.right.end===s.right.end,o.push(t)}return o}(0,f.Z)(function(){let e=tL(window.location.hash);if(e){if((0,eM.Q)(document,e.hashFragment)&&!e.lastLine)return;tE(e,0)}}),(0,a.on)("click",".js-expand",function(e){e.preventDefault(),t_(e.currentTarget)}),(0,a.on)("click",".js-expand-full",async e=>{e.preventDefault();let t=e.currentTarget,n=t.closest(".file"),r=t.getAttribute("data-url"),o=tH(n);function s(){t.setAttribute("hidden","true");let e=n.querySelector(".js-collapse-diff");e&&e.removeAttribute("hidden"),n.classList.add("open"),n.classList.add("Details--on")}if(tR(n,tw.j))return void s();if(0===o.length)return;let l=new URL(r,window.location.origin),i=new URLSearchParams(l.search.slice(1));for(let e of o)i.append("ranges[]last_left",e.left.start),i.append("ranges[]left",e.left.end),i.append("ranges[]left_hunk_size",e.left.size),i.append("ranges[]last_right",e.right.start),i.append("ranges[]right",e.right.end),i.append("ranges[]right_hunk_size",e.right.size),i.append("ranges[]position",e.position);l.search=i.toString();let a=await tM(document,l.toString()),c=[...n.querySelectorAll(".js-expand")];for(let{content:e,position:t}of a){let n=parseInt(t,10),r=c[n];if(!r)return;let o=r.closest(".js-expandable-line"),s=tx(o,".file-diff-line");s?(0,tl.uQ)(s,()=>{o.after(e)}):o.after(e),o.setAttribute("hidden","true")}s()}),(0,a.on)("click",".js-collapse-diff",e=>{let t=e.currentTarget,n=t.closest(".file");function r(){t.setAttribute("hidden","true");let e=n.querySelector(".js-expand-full");e&&e.removeAttribute("hidden")}if(tR(n,tw.fK))return void r();let o=[...n.querySelectorAll('.blob-expanded[data-expanded-full="true"]')];for(let e of o)e.parentElement.removeChild(e);let s=[...n.querySelectorAll(".js-expandable-line")];for(let e of s)e.removeAttribute("hidden");r()});let DiffTableSideProtection=class DiffTableSideProtection{range(){let e;return this.selection?.rangeCount>0&&(e=this.selection.getRangeAt(0)),e}canBeSideProtected(){try{return!!(this.hasSelectedText()&&this.confinedTable())}catch(e){return!1}}isSideProtected(){try{return!!this.confinedTable()?.getAttribute("data-lock-side-selection")}catch(e){return!1}}hasSelectedText(){let e=this.range();return!!e&&e.toString().length>0}clearSelectedText(){this.selection.removeAllRanges()}confinedTable(){let e=this.range()?.commonAncestorContainer?.parentElement;if(e?.matches(".diff-table"))return e;if(e?.matches(".js-file-content")){let t=e?.querySelector("table.diff-table");return t}{let t=e?.closest("table.diff-table");return t}}unprotectedSide(){let e;return e=this.anchorNode instanceof HTMLTableCellElement?this.anchorNode.closest("td[data-split-side]"):this.anchorNode?.parentElement?.closest("td[data-split-side]"),e?.getAttribute("data-split-side")}protectedSide(){return"left"===this.unprotectedSide()?"right":"left"}applySideProtection(){if(this.unprotectedSide()){let e=this.confinedTable(),t=this.unprotectedSide();e&&t&&e.setAttribute("data-lock-side-selection",t)}}clearSideProtection(){let e=document.querySelectorAll("table[data-lock-side-selection]");for(let t of e){let e=t;e.removeAttribute("data-lock-side-selection")}}filteredTableRows(){let e=[];for(let t=0;t<this.selection.rangeCount;t++){let n=this.selection.getRangeAt(t),r=n.cloneContents();if(r.querySelectorAll("td").length){let t=`td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell, .inline-comments`,n=r.querySelectorAll(t);for(let e of n)e.parentNode&&e.parentNode.removeChild(e);e.push(...r.children)}else{let t=document.createElement("TR"),n=document.createElement("TD");n.append(...r.childNodes),t.append(n),e.push(t)}}return e}contentToString(){let e=[],t=document.createElement("table");t.classList.add("invisible"),t.append(...this.filteredTableRows()),this.confinedTable()?.append(t);let n=t.children;for(let t=0;t<n.length;t++){let r=n[t],o=r.innerText;o&&("\n"===o?e.push(""):e.push(o))}return t.remove(),e.join("\n")}constructor(e){this.selection=e,this.anchorNode=e.anchorNode}};function tF(e){return Math.floor(e/2)}function tP(e){let t=e.querySelector(".js-comment-button-placeholder");if(t?.parentElement){let n=document.querySelector(".js-comment-button-template");if(!n)throw Error("missing js-comment-button-template template element!");let r=t.dataset;if(!r)throw Error("placeholder element has no dataset");r.originalLine=e.querySelector(".blob-code-inner")?.textContent||"";let o=new F.R(n,r);if(t.parentElement.replaceChild(o,t),r.expandedDiff){let t=e.querySelector(".js-add-line-comment");t&&t.setAttribute("data-expanded-diff",r.expandedDiff)}}}function t$(e,t){let n=e.parentElement;n&&(tP(n),tD(n,e,t))}function tD(e,t,n){let r;let o=e.children;if(4===o.length)for(let e=0,n=o.length;e<n;e++){let n=o[e];n===t&&(r=tF(e))}for(let e=0,t=o.length;e<t;e++){let t=o[e];(null==r||tF(e)===r)&&t.classList.toggle("is-hovered",n)}}function tN(e){let t=document.getSelection();if(t){let n=new DiffTableSideProtection(t);n.isSideProtected()&&(e.clipboardData?.setData("text/plain",n.contentToString()),e.preventDefault())}}function tO(e){let t=document.getSelection(),n=2===e.button;if(t&&!n){let e=new DiffTableSideProtection(t);e.isSideProtected()&&(e.clearSelectedText(),e.clearSideProtection())}}function tB(){let e=document.getSelection();if(e){let t=new DiffTableSideProtection(e);t.canBeSideProtected()?t.applySideProtection():t.clearSideProtection()}}(0,m.N7)(".diff-table",function(e){let t=null;function n(){t&&t$(t,!1),t=null}function r(e){t&&t$(t,!1),e.target instanceof HTMLElement&&(t=e.target.closest("td.blob-code"))&&t$(t,!0)}return{add:function(){e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",n),e.addEventListener("mouseover",r)},remove:function(){e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",n),e.removeEventListener("mouseover",r)}}}),(0,m.N7)(".js-diff-container",function(){return{add:function(){document.addEventListener("copy",tN),document.addEventListener("mousedown",tO),document.addEventListener("selectionchange",tB)},remove:function(){document.removeEventListener("copy",tN),document.removeEventListener("mousedown",tO),document.removeEventListener("selectionchange",tB)}}});var tW=n(99874);function tU(){let e=document.querySelector("meta[name=diff-view]"),t=e&&e instanceof HTMLMetaElement?e.content:"",n=document.querySelector(".js-file-diff-split"),r=!!("split"===t&&n||document.querySelector(".wants-full-width-container"));document.body.classList.toggle("full-width",r)}function tz(e){let t=e.some(e=>e.checked);for(let n of e)(0,P.Se)(n,!t)}(0,m.N7)("meta[name=diff-view]",{add:tU,remove:tU}),(0,m.N7)(".js-file-diff-split",{add:tU,remove:tU}),(0,m.N7)(".js-compare-tab.selected",{add:tU,remove:tU}),(0,m.N7)(".wants-full-width-container",{add:tU,remove:tU}),(0,a.on)("change",".js-toggle-file-notes",function(e){let t=e.currentTarget;t.closest(".file").classList.toggle("show-inline-notes",t.checked)}),(0,a.on)("click",".js-toggle-all-file-notes",function(e){let t=Array.from(document.querySelectorAll(".js-toggle-file-notes"));tz(t),e.preventDefault()}),(0,a.on)("click",".js-toggle-all-file-annotations",function(e){let t=Array.from(document.querySelectorAll(".js-toggle-file-check-annotations"));tz(t),e.preventDefault()}),(0,m.N7)(".js-inline-comments-container",function(e){let t;let n=e.closest(".file");if(n){let e=t=function(){let e=null!=n.querySelector(".js-inline-comments-container");n.classList.toggle("has-inline-notes",e)};return{add:e,remove:t}}}),(0,a.on)("change",".js-toggle-file-check-annotations",function(e){let t=e.currentTarget,n=t.closest(".file").querySelectorAll(".js-inline-annotations");for(let e of n)e instanceof HTMLElement&&(e.hidden=!t.checked)});var tQ=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l};let tX=class DiffFileFilterElement extends HTMLElement{connectedCallback(){this.filterState={hideDeletedFiles:!1,hideViewedFiles:!1,showManifestFilesOnly:!1,selectedOwners:[],showCodeownersFiles:!1,selectedFileTypes:[],fileTypeFilterActive:!1,filtersActive:!1}}applyFilter(e){this.filterState=e.detail,this.showResetFilters(),this.filterFiles(),this.filterTreeFiles(),this.hideEmptyDirectories(),this.showBlankslateIfEmpty()}clearFilters(e){e.preventDefault(),this.fileFilter.clearFilters()}filterFiles(){for(let e of this.diffEntries){let t=e.closest(".js-file.js-details-container");t.hidden=!this.shouldShowFile(e)}}filterTreeFiles(){for(let e of this.treeEntries){let t=this.shouldShowFile(e);e.hidden=!t,e.toggleAttribute("data-skip-substring-filter",!t)}}hideEmptyDirectories(){this.treeRoot&&this.hideEmptyDirectory(this.treeRoot)}hideEmptyDirectory(e){let t="root"===e.getAttribute("data-tree-entry-type"),n="directory"===e.getAttribute("data-tree-entry-type");if(t||n){let n=e.querySelectorAll(t?":scope > .js-tree-node":":scope > ul > .js-tree-node"),r=0;for(let e of n)r+=this.hideEmptyDirectory(e);return 0===r?(e.hidden=!0,0):(e.hidden=!1,1)}return e.hidden?0:1}async refilterAfterAsyncLoad(){await Promise.resolve(),this.refilterLoadedFiles(),this.showBlankslateIfEmpty()}refilterLoadedFiles(){this.filterState.filtersActive&&this.filterFiles()}shouldShowFile(e){let t=!0,n=e.getAttribute("data-file-type");if(n&&(t=this.filterState.selectedFileTypes.includes(n)),this.filterState.hideViewedFiles&&t){let n=e.hasAttribute("data-file-user-viewed");n&&(t=!1)}if(this.filterState.showCodeownersFiles&&t){let n=(e.getAttribute("data-codeowners")||"").split(",");t=n.filter(e=>this.filterState.selectedOwners.includes(e)).length>0}if(this.filterState.hideDeletedFiles&&t){let n="true"===e.getAttribute("data-file-deleted");n&&(t=!1)}if(this.filterState.showManifestFilesOnly&&t){let n=e.hasAttribute("data-file-manifest");n||(t=!1)}return t}showResetFilters(){this.resetFilters&&(this.resetFilters.hidden=!this.filterState.filtersActive)}showBlankslateIfEmpty(){if(!this.blankslate)return;if(this.progressiveLoaders.length>0||0===this.diffEntries.length){this.blankslate.hidden=!0;return}let e=Array.from(this.diffEntries).some(e=>!e.hidden);this.blankslate.hidden=e}};tQ([eG.fA],tX.prototype,"blankslate",void 0),tQ([eG.fA],tX.prototype,"resetFilters",void 0),tQ([eG.GO],tX.prototype,"diffEntries",void 0),tQ([eG.GO],tX.prototype,"progressiveLoaders",void 0),tQ([eG.GO],tX.prototype,"treeEntries",void 0),tQ([eG.fA],tX.prototype,"treeRoot",void 0),tQ([eG.fA],tX.prototype,"fileFilter",void 0),tQ([(0,eJ.D)(20)],tX.prototype,"hideEmptyDirectories",null),tX=tQ([eG.Ih],tX);var tZ=n(19146),tK=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l};let tV=class InputDemuxBaseChangeContext{onItemSelected(e){if(!(e.currentTarget instanceof HTMLButtonElement))return;let t=e.currentTarget.querySelector(".js-ref-name").textContent,n=document.querySelector(".js-new-base-branch");n.value=btoa(unescape(encodeURIComponent(t||"")));let r=document.querySelector(".js-change-base-template").content.cloneNode(!0);r instanceof DocumentFragment&&(0,tZ.W)({content:r})}},tY=class InputDemuxContextWrapperElement extends HTMLElement{connectedCallback(){let e=this.getAttribute("data-context-type"),t={baseChange:new tV};this.context=t[e]}onItemSelected(e){this.context.onItemSelected(e)}};tY=tK([eG.Ih],tY);var tG=n(55843),tJ=n(82368),t0=n(58541),t1=n(57088)},78232:(e,t,n)=>{n.d(t,{j:()=>l,w:()=>i});var r=n(59753),o=n(64611),s=n(254);function l(e){let t=e.querySelector(".js-inline-comment-form-container");t.classList.add("open"),t.querySelector(".js-write-tab")?.click(),t.querySelector(".js-comment-field").focus(),(0,r.f)(t,"inlinecomment:focus")}function i(e){e.reset();let t=e.closest(".js-inline-comment-form-container");t.classList.remove("open");let n=t.querySelector(".js-multi-line-preview");n&&(n.hidden=!0),(0,r.f)(t,"inlinecomment:collapse")}(0,r.on)("click",".js-toggle-inline-comment-form",function(e){let t=e.currentTarget.closest(".js-line-comments");l(t)}),(0,r.on)("quote-selection",".js-line-comments",function(e){l(e.currentTarget),e.stopPropagation()}),(0,s.w4)("keydown",".js-inline-comment-form-container form .js-comment-field",function(e){let t=e.target;if(!t.classList.contains("js-navigation-enable")&&"Escape"===e.key&&0===t.value.length){let n=t.closest("form");i(n),e.preventDefault()}}),(0,r.on)("click",".js-hide-inline-comment-form",function(e){let t=e.currentTarget.closest("form");!(0,o.T)(t)||confirm(e.currentTarget.getAttribute("data-confirm-cancel-text"))?i(t):e.preventDefault()})},67404:(e,t,n)=>{function r(e){return o(e)[0]}function o(e){let t=[];for(let n of s()){let[r,o]=n.trim().split("=");e===r&&void 0!==o&&t.push({key:r,value:o})}return t}function s(){try{return document.cookie.split(";")}catch{return[]}}function l(e,t,n=null,r=!1,o="lax"){let s=document.domain;if(null==s)throw Error("Unable to get document domain");s.endsWith(".github.com")&&(s="github.com");let l="https:"===location.protocol?"; secure":"",i=n?`; expires=${n}`:"";!1===r&&(s=`.${s}`);try{document.cookie=`${e}=${t}; path=/; domain=${s}${i}${l}; samesite=${o}`}catch{}}function i(e,t=!1){let n=document.domain;if(null==n)throw Error("Unable to get document domain");n.endsWith(".github.com")&&(n="github.com");let r=new Date().getTime(),o=new Date(r-1).toUTCString(),s="https:"===location.protocol?"; secure":"",l=`; expires=${o}`;!1===t&&(n=`.${n}`);try{document.cookie=`${e}=''; path=/; domain=${n}${l}${s}`}catch{}}n.d(t,{$1:()=>o,d8:()=>l,ej:()=>r,kT:()=>i})},19146:(e,t,n)=>{n.d(t,{W:()=>o});var r=n(59753);async function o(e){let t=document.querySelector("#site-details-dialog"),n=t.content.cloneNode(!0),o=n.querySelector("details"),s=o.querySelector("details-dialog"),l=o.querySelector(".js-details-dialog-spinner");e.detailsClass&&o.classList.add(...e.detailsClass.split(" ")),e.dialogClass&&s.classList.add(...e.dialogClass.split(" ")),e.label?s.setAttribute("aria-label",e.label):e.labelledBy&&s.setAttribute("aria-labelledby",e.labelledBy),document.body.append(n);try{let t=await e.content;l.remove(),s.prepend(t)}catch(n){l.remove();let t=document.createElement("span");t.textContent=e.errorMessage||"Couldn't load the content",t.classList.add("my-6"),t.classList.add("mx-4"),s.prepend(t)}return o.addEventListener("toggle",()=>{o.hasAttribute("open")||((0,r.f)(s,"dialog:remove"),o.remove())}),s}},33537:(e,t,n)=>{n.d(t,{X:()=>o});var r=n(9302);function o(e,t,n,o,s,l,i,a,c=window.location.search){let d=document.querySelector(".js-file-filter"),u=new URL(window.location.href,window.location.origin),f=new URLSearchParams(c),m=f.get("w");if(!e&&!o){if(l)return;let e=new URLSearchParams,t=f.get("diff");t&&e.set("diff",t),m&&e.set("w",m),u.search=e.toString(),(0,r.lO)((0,r.y0)(),"",u.toString());return}let g=d.querySelector(".js-file-filter-form"),h=new FormData(g),p=n.filter(e=>!h.getAll("file-filters[]").includes(e)),b=s.filter(e=>!h.getAll("owned-by[]").includes(e));for(let e of p)h.append("file-filters[]",e);for(let e of b)h.append("owned-by[]",e);let y=new URLSearchParams(h);y.has("file-filters[]")&&""!==y.toString()||y.set("file-filters[]",""),t&&y.set("w",m??"1"),l&&y.set("manifests","true"),i&&y.set("show-deleted-files","false"),a&&y.set("show-viewed-files","false"),y.delete("authenticity_token"),u.search=y.toString(),(0,r.lO)((0,r.y0)(),"",u.toString())}},34892:(e,t,n)=>{n.d(t,{DF:()=>u,Fr:()=>f,a_:()=>d});var r=n(67525);function o(e){let t=[...e.querySelectorAll("meta[name=html-safe-nonce]")].map(e=>e.content);if(t.length<1)throw Error("could not find html-safe-nonce on document");return t}let s=class ResponseError extends Error{constructor(e,t){super(`${e} for HTTP ${t.status}`),this.response=t}};function l(e,t,n=!1){let r=t.headers.get("content-type")||"";if(!n&&!r.startsWith("text/html"))throw new s(`expected response with text/html, but was ${r}`,t);if(n&&!(r.startsWith("text/html")||r.startsWith("application/json")))throw new s(`expected response with text/html or application/json, but was ${r}`,t);let o=t.headers.get("x-html-safe");if(o){if(!e.includes(o))throw new s("response X-HTML-Safe nonce did not match",t)}else throw new s("missing X-HTML-Safe nonce",t)}var i=n(22490),a=n(7180);let c=i.Z.createPolicy("server-x-safe-html",{createHTML:(e,t)=>a.O.apply({policy:()=>(l(o(document),t),e),fallback:e})});async function d(e,t,n){let o=new Request(t,n);o.headers.append("X-Requested-With","XMLHttpRequest");let s=await self.fetch(o);if(s.status<200||s.status>=300)throw Error(`HTTP ${s.status}${s.statusText||""}`);let l=c.createHTML(await s.text(),s);return(0,r.r)(e,l)}function u(e,t,n=1e3,r=[200]){return async function n(o){let s=new Request(e,t);s.headers.append("X-Requested-With","XMLHttpRequest");let l=await self.fetch(s);if(202===l.status)return await new Promise(e=>setTimeout(e,o)),n(1.5*o);if(r.includes(l.status))return l;if(l.status<200||l.status>=300)throw Error(`HTTP ${l.status}${l.statusText||""}`);throw Error(`Unexpected ${l.status} response status from poll endpoint`)}(n)}async function f(e,t,n){let{wait:r=500,acceptedStatusCodes:o=[200],max:s=3,attempt:l=0}=n||{},i=async()=>new Promise((n,i)=>{setTimeout(async()=>{try{let r=new Request(e,t);r.headers.append("X-Requested-With","XMLHttpRequest");let i=await self.fetch(r);if(o.includes(i.status)||l+1===s)return n(i);n("retry")}catch(e){i(e)}},r*l)}),a=await i();return"retry"!==a?a:f(e,t,{wait:r,acceptedStatusCodes:o,max:s,attempt:l+1})}},55843:(e,t,n)=>{var r=n(76006),o=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l};let s=class InputDemuxElement extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));let e=this.closest("details");e&&e.addEventListener("toggle",()=>{e.open&&this.source.focus()})}relayKeydown(e){if((this.isControlTab(e.target)||e.target===this.source)&&("ArrowDown"===e.key||"Tab"===e.key))e.preventDefault(),e.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if("Escape"===e.key){let e=this.closest("details");e&&e.removeAttribute("open")}}isControlTab(e){return!!e&&!!this.control&&Array.from(this.control.children).includes(e)}relayInput(e){if(!e.target)return;let t=e.target,n=t.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:n}))}routeCustomEvent(e){let t=this.sinks[this.selectedIndex];t.dispatchEvent(e)}get selectedIndex(){if(!this.control)return 0;let e=this.control.querySelector('[aria-selected="true"]');return e?Array.from(this.control.children).indexOf(e):0}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(e){this.source.value=this.storedInput[this.selectedIndex];let t=e.detail.relatedTarget.getAttribute("data-filter-placeholder");this.source.placeholder=t,this.source.setAttribute("aria-label",t),this.notifySelected()}notifySelected(){let e=this.sinks[this.selectedIndex],t=new CustomEvent("tab-selected");e.dispatchEvent(t)}};o([r.fA],s.prototype,"source",void 0),o([r.GO],s.prototype,"sinks",void 0),o([r.fA],s.prototype,"control",void 0),s=o([r.Ih],s)},58541:(e,t,n)=>{var r=n(36071);let o=()=>{let e=document.getElementById("spoof-warning");if(!e)return;let t=document.querySelector(".commit-title");t&&t.classList.add("pb-1"),e.hidden=!1,e.removeAttribute("aria-hidden")};(0,r.N7)("#js-spoofed-commit-warning-trigger",{add:o})},40458:(e,t,n)=>{n.d(t,{Z:()=>m});var r=n(19146),o=n(34892);function s(e){return new Promise(t=>{e.addEventListener("dialog:remove",t,{once:!0})})}function l(e){let t=document.querySelector(".sso-modal");t&&(t.classList.remove("success","error"),e?t.classList.add("success"):t.classList.add("error"))}function i(e){let t=document.querySelector("meta[name=sso-expires-around]");t&&t.setAttribute("content",e)}async function a(){let e=document.querySelector("link[rel=sso-modal]"),t=await (0,r.W)({content:(0,o.a_)(document,e.href),dialogClass:"sso-modal"}),n=null,a=window.external;if(a.ssoComplete=function(e){e.error?l(n=!1):(l(n=!0),i(e.expiresAround),window.focus()),a.ssoComplete=null},await s(t),!n)throw Error("sso prompt canceled")}function c(e){if(!(e instanceof HTMLMetaElement))return!0;let t=parseInt(e.content),n=new Date().getTime()/1e3;return n>t}async function d(){let e=document.querySelector("link[rel=sso-session]"),t=document.querySelector("meta[name=sso-expires-around]");if(!(e instanceof HTMLLinkElement)||!c(t))return!0;let n=e.href,r=await fetch(n,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),o=await r.json();return o}(0,n(36071).N7)(".js-sso-modal-complete",function(e){if(window.opener&&window.opener.external.ssoComplete){let t=e.getAttribute("data-error"),n=e.getAttribute("data-expires-around");window.opener.external.ssoComplete({error:t,expiresAround:n}),window.close()}else{let t=e.getAttribute("data-fallback-url");t&&(window.location.href=t)}});let u=null;function f(){u=null}async function m(){let e=await d();e||(u||(u=a().then(f).catch(f)),await u)}},46426:(e,t,n)=>{n.d(t,{$:()=>a,c:()=>l});var r=n(15205);let o=(0,r.Z)(s);function s(){return(document.head?.querySelector('meta[name="enabled-features"]')?.content||"").split(",")}let l=(0,r.Z)(i);function i(e){return -1!==o().indexOf(e)}let a={isFeatureEnabled:l}},7180:(e,t,n)=>{n.d(t,{O:()=>i,d:()=>TrustedTypesPolicyError});var r=n(46426),o=n(71643),s=n(24601);let TrustedTypesPolicyError=class TrustedTypesPolicyError extends Error{};function l({policy:e,fallback:t,fallbackOnError:n=!1}){try{if((0,r.c)("BYPASS_TRUSTED_TYPES_POLICY_RULES"))return t;return e()}catch(e){if(e instanceof TrustedTypesPolicyError||((0,s.eK)(e),(0,o.b)({incrementKey:"TRUSTED_TYPES_POLICY_ERROR"}),!n))throw e}return t}let i={apply:l}}},e=>{var t=t=>e(e.s=t);e.O(0,["vendors-node_modules_github_selector-observer_dist_index_esm_js","vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-a4c183","vendors-node_modules_lit-html_lit-html_js","vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js","vendors-node_modules_virtualized-list_es_index_js-node_modules_github_template-parts_lib_index_js","vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_github_remote-form_-e3de2b","vendors-node_modules_github_clipboard-copy-element_dist_index_esm_js-node_modules_scroll-anch-c93c97","ui_packages_failbot_failbot_ts","app_assets_modules_github_updatable-content_ts","app_assets_modules_github_ref-selector_ts","app_assets_modules_github_sticky-scroll-into-view_ts","app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-f96c66","app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-2e2258"],()=>t(70499));var n=e.O()}]);
//# sourceMappingURL=diffs-c18522a94a8d.js.map