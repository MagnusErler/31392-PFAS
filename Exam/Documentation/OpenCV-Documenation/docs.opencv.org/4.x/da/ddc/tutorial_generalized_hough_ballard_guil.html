<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from docs.opencv.org/4.x/da/ddc/tutorial_generalized_hough_ballard_guil.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 11 May 2023 10:23:23 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>OpenCV: Object detection with Generalized Ballard and Guil Hough Transform</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.html", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
          fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
          forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
          forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
          vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
          vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
          cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
          distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
          distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
          hdotsfor: ["\\dots", 1],
          mathbbm: ["\\mathbb{#1}", 1],
          bordermatrix: ["\\matrix{#1}", 1]
      }
  }
}
);
//]]>
</script><script type="text/javascript" src="../../../../cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<script>
  (function() {
    var cx = '002541620211387084530:kaexgxg7oxu';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = '../../../../cse.google.com/cse07b6.html?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
<script type="text/javascript" src="../../../version.js"></script>

<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.7.0-dev</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../index-2.html',true,false,'search.html','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/df8/tutorial_root.html">OpenCV Tutorials</a></li><li class="navelem"><a class="el" href="../../d7/da8/tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Object detection with Generalized Ballard and Guil Hough Transform </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Prev Tutorial:</b> <a class="el" href="../../d4/d70/tutorial_hough_circle.html">Hough Circle Transform</a></p>
<p><b>Next Tutorial:</b> <a class="el" href="../../d1/da0/tutorial_remap.html">Remapping</a></p>
<table class="doxtable">
<tr>
<th align="right"></th><th align="left"></th></tr>
<tr>
<td align="right">Original author </td><td align="left">Markus Heck </td></tr>
<tr>
<td align="right">Compatibility </td><td align="left">OpenCV &gt;= 3.4 </td></tr>
</table>
<h2>Goal </h2>
<p>In this tutorial you will learn how to:</p>
<ul>
<li>Use <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> and <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a> to detect an object</li>
</ul>
<h2>Example </h2>
<h3>What does this program do?</h3>
<ol type="1">
<li>Load the image and template</li>
</ol>
<div class="image">
<img src="../../generalized_hough_mini_image.jpg" alt="generalized_hough_mini_image.jpg"/>
<div class="caption">
image</div></div>
<div class="image">
<img src="../../generalized_hough_mini_template.jpg" alt="generalized_hough_mini_template.jpg"/>
<div class="caption">
template</div></div>
<ol type="1">
<li>Instantiate <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> with the help of <code><a class="el" href="../../d3/dc0/group__imgproc__shape.html#ga3252811b8a7a5f606dc0a88927982ee9" title="Creates a smart pointer to a cv::GeneralizedHoughBallard class and initializes it. ">createGeneralizedHoughBallard()</a></code></li>
<li>Instantiate <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a> with the help of <code><a class="el" href="../../d3/dc0/group__imgproc__shape.html#gae2eb1e12452257b63d09ba9ce871f58c" title="Creates a smart pointer to a cv::GeneralizedHoughGuil class and initializes it. ">createGeneralizedHoughGuil()</a></code></li>
<li>Set the required parameters for both GeneralizedHough variants</li>
<li>Detect and show found results</li>
</ol>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Both variants can't be instantiated directly. Using the create methods is required.</li>
<li>Guil Hough is very slow. Calculating the results for the "mini" files used in this tutorial takes only a few seconds. With image and template in a higher resolution, as shown below, my notebook requires about 5 minutes to calculate a result.</li>
</ul>
</dd></dl>
<div class="image">
<img src="../../generalized_hough_image.jpg" alt="generalized_hough_image.jpg"/>
<div class="caption">
image</div></div>
<div class="image">
<img src="../../generalized_hough_template.jpg" alt="generalized_hough_template.jpg"/>
<div class="caption">
template</div></div>
 <h3>Code</h3>
<p>The complete code for this tutorial is shown below. </p><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">opencv2/imgproc.hpp</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/d75/namespacecv.html">cv</a>;</div><div class="line"><span class="keyword">using namespace </span>std;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {</div><div class="line"><span class="comment">//  load source image and grayscale template</span></div><div class="line">    <a class="code" href="../../d6/dba/group__core__utils__samples.html#gaa54838b2113b79689df232c190de969e">samples::addSamplesDataSearchSubDirectory</a>(<span class="stringliteral">&quot;doc/tutorials/imgproc/generalized_hough_ballard_guil&quot;</span>);</div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> image = <a class="code" href="../../d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(<span class="stringliteral">&quot;images/generalized_hough_mini_image.jpg&quot;</span>));</div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> templ = <a class="code" href="../../d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(<span class="stringliteral">&quot;images/generalized_hough_mini_template.jpg&quot;</span>), <a class="code" href="../../d8/d6a/group__imgcodecs__flags.html#gga61d9b0126a3e57d9277ac48327799c80ae29981cfc153d3b0cef5c0daeedd2125">IMREAD_GRAYSCALE</a>);</div><div class="line"></div><div class="line"><span class="comment">//  create grayscale image</span></div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> grayImage;</div><div class="line">    <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#ga397ae87e1288a81d2363b61574eb8cab">cvtColor</a>(image, grayImage, <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gga4e0972be5de079fed4e3a10e24ef5ef0ae50d0c66ee53e974234ac84cf51d1d4e">COLOR_RGB2GRAY</a>);</div><div class="line"></div><div class="line"><span class="comment">//  create variable for location, scale and rotation of detected templates</span></div><div class="line">    vector&lt;Vec4f&gt; positionBallard, positionGuil;</div><div class="line"></div><div class="line"><span class="comment">//  template width and height</span></div><div class="line">    <span class="keywordtype">int</span> w = templ.<a class="code" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>;</div><div class="line">    <span class="keywordtype">int</span> h = templ.<a class="code" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  create ballard and set options</span></div><div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughBallard&gt;</a> ballard = <a class="code" href="../../d3/dc0/group__imgproc__shape.html#ga3252811b8a7a5f606dc0a88927982ee9">createGeneralizedHoughBallard</a>();</div><div class="line">    ballard-&gt;setMinDist(10);</div><div class="line">    ballard-&gt;setLevels(360);</div><div class="line">    ballard-&gt;setDp(2);</div><div class="line">    ballard-&gt;setMaxBufferSize(1000);</div><div class="line">    ballard-&gt;setVotesThreshold(40);</div><div class="line"></div><div class="line">    ballard-&gt;setCannyLowThresh(30);</div><div class="line">    ballard-&gt;setCannyHighThresh(110);</div><div class="line">    ballard-&gt;setTemplate(templ);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  create guil and set options</span></div><div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughGuil&gt;</a> guil = <a class="code" href="../../d3/dc0/group__imgproc__shape.html#gae2eb1e12452257b63d09ba9ce871f58c">createGeneralizedHoughGuil</a>();</div><div class="line">    guil-&gt;setMinDist(10);</div><div class="line">    guil-&gt;setLevels(360);</div><div class="line">    guil-&gt;setDp(3);</div><div class="line">    guil-&gt;setMaxBufferSize(1000);</div><div class="line"></div><div class="line">    guil-&gt;setMinAngle(0);</div><div class="line">    guil-&gt;setMaxAngle(360);</div><div class="line">    guil-&gt;setAngleStep(1);</div><div class="line">    guil-&gt;setAngleThresh(1500);</div><div class="line"></div><div class="line">    guil-&gt;setMinScale(0.5);</div><div class="line">    guil-&gt;setMaxScale(2.0);</div><div class="line">    guil-&gt;setScaleStep(0.05);</div><div class="line">    guil-&gt;setScaleThresh(50);</div><div class="line"></div><div class="line">    guil-&gt;setPosThresh(10);</div><div class="line"></div><div class="line">    guil-&gt;setCannyLowThresh(30);</div><div class="line">    guil-&gt;setCannyHighThresh(110);</div><div class="line"></div><div class="line">    guil-&gt;setTemplate(templ);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  execute ballard detection</span></div><div class="line">    ballard-&gt;detect(grayImage, positionBallard);</div><div class="line"><span class="comment">//  execute guil detection</span></div><div class="line">    guil-&gt;detect(grayImage, positionGuil);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  draw ballard</span></div><div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionBallard.begin(); iter != positionBallard.end(); ++iter) {</div><div class="line">        <a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a>((*iter)[0], (*iter)[1]),</div><div class="line">                                        <a class="code" href="../../dc/d84/group__core__basic.html#gab34496d2466b5f69930ab74c70f117d4">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div><div class="line">                                        (*iter)[3]);</div><div class="line">        <a class="code" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div><div class="line">        rRect.<a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line">            <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga7078a9fae8c7e7d13d24dac2520ae4a2">line</a>(image, vertices[i], vertices[(i + 1) % 4], <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(255, 0, 0), 6);</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="comment">//  draw guil</span></div><div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionGuil.begin(); iter != positionGuil.end(); ++iter) {</div><div class="line">        <a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a>((*iter)[0], (*iter)[1]),</div><div class="line">                                        <a class="code" href="../../dc/d84/group__core__basic.html#gab34496d2466b5f69930ab74c70f117d4">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div><div class="line">                                        (*iter)[3]);</div><div class="line">        <a class="code" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div><div class="line">        rRect.<a class="code" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line">            <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga7078a9fae8c7e7d13d24dac2520ae4a2">line</a>(image, vertices[i], vertices[(i + 1) % 4], <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(0, 255, 0), 2);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>(<span class="stringliteral">&quot;result_img&quot;</span>, image);</div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">waitKey</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><h2>Explanation </h2>
<h3>Load image, template and setup variables</h3>
<div class="fragment"><div class="line"><span class="comment">//  load source image and grayscale template</span></div><div class="line">    <a class="code" href="../../d6/dba/group__core__utils__samples.html#gaa54838b2113b79689df232c190de969e">samples::addSamplesDataSearchSubDirectory</a>(<span class="stringliteral">&quot;doc/tutorials/imgproc/generalized_hough_ballard_guil&quot;</span>);</div><div class="line">    Mat image = <a class="code" href="../../d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(<span class="stringliteral">&quot;images/generalized_hough_mini_image.jpg&quot;</span>));</div><div class="line">    Mat templ = <a class="code" href="../../d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(<span class="stringliteral">&quot;images/generalized_hough_mini_template.jpg&quot;</span>), <a class="code" href="../../d8/d6a/group__imgcodecs__flags.html#gga61d9b0126a3e57d9277ac48327799c80ae29981cfc153d3b0cef5c0daeedd2125">IMREAD_GRAYSCALE</a>);</div><div class="line"></div><div class="line"><span class="comment">//  create grayscale image</span></div><div class="line">    Mat grayImage;</div><div class="line">    <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#ga397ae87e1288a81d2363b61574eb8cab">cvtColor</a>(image, grayImage, <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gga4e0972be5de079fed4e3a10e24ef5ef0ae50d0c66ee53e974234ac84cf51d1d4e">COLOR_RGB2GRAY</a>);</div><div class="line"></div><div class="line"><span class="comment">//  create variable for location, scale and rotation of detected templates</span></div><div class="line">    vector&lt;Vec4f&gt; positionBallard, positionGuil;</div><div class="line"></div><div class="line"><span class="comment">//  template width and height</span></div><div class="line">    <span class="keywordtype">int</span> w = templ.cols;</div><div class="line">    <span class="keywordtype">int</span> h = templ.rows;</div></div><!-- fragment --><p> The position vectors will contain the matches the detectors will find. Every entry contains four floating point values: position vector</p>
<ul>
<li><em>[0]</em>: x coordinate of center point</li>
<li><em>[1]</em>: y coordinate of center point</li>
<li><em>[2]</em>: scale of detected object compared to template</li>
<li><em>[3]</em>: rotation of detected object in degree in relation to template</li>
</ul>
<p>An example could look as follows: <code>[200, 100, 0.9, 120]</code></p>
<h3>Setup parameters</h3>
<div class="fragment"><div class="line"><span class="comment">//  create ballard and set options</span></div><div class="line">    Ptr&lt;GeneralizedHoughBallard&gt; ballard = <a class="code" href="../../d3/dc0/group__imgproc__shape.html#ga3252811b8a7a5f606dc0a88927982ee9">createGeneralizedHoughBallard</a>();</div><div class="line">    ballard-&gt;setMinDist(10);</div><div class="line">    ballard-&gt;setLevels(360);</div><div class="line">    ballard-&gt;setDp(2);</div><div class="line">    ballard-&gt;setMaxBufferSize(1000);</div><div class="line">    ballard-&gt;setVotesThreshold(40);</div><div class="line"></div><div class="line">    ballard-&gt;setCannyLowThresh(30);</div><div class="line">    ballard-&gt;setCannyHighThresh(110);</div><div class="line">    ballard-&gt;setTemplate(templ);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  create guil and set options</span></div><div class="line">    Ptr&lt;GeneralizedHoughGuil&gt; guil = <a class="code" href="../../d3/dc0/group__imgproc__shape.html#gae2eb1e12452257b63d09ba9ce871f58c">createGeneralizedHoughGuil</a>();</div><div class="line">    guil-&gt;setMinDist(10);</div><div class="line">    guil-&gt;setLevels(360);</div><div class="line">    guil-&gt;setDp(3);</div><div class="line">    guil-&gt;setMaxBufferSize(1000);</div><div class="line"></div><div class="line">    guil-&gt;setMinAngle(0);</div><div class="line">    guil-&gt;setMaxAngle(360);</div><div class="line">    guil-&gt;setAngleStep(1);</div><div class="line">    guil-&gt;setAngleThresh(1500);</div><div class="line"></div><div class="line">    guil-&gt;setMinScale(0.5);</div><div class="line">    guil-&gt;setMaxScale(2.0);</div><div class="line">    guil-&gt;setScaleStep(0.05);</div><div class="line">    guil-&gt;setScaleThresh(50);</div><div class="line"></div><div class="line">    guil-&gt;setPosThresh(10);</div><div class="line"></div><div class="line">    guil-&gt;setCannyLowThresh(30);</div><div class="line">    guil-&gt;setCannyHighThresh(110);</div><div class="line"></div><div class="line">    guil-&gt;setTemplate(templ);</div></div><!-- fragment --><p> Finding the optimal values can end up in trial and error and depends on many factors, such as the image resolution.</p>
<h3>Run detection</h3>
<div class="fragment"><div class="line"><span class="comment">//  execute ballard detection</span></div><div class="line">    ballard-&gt;detect(grayImage, positionBallard);</div><div class="line"><span class="comment">//  execute guil detection</span></div><div class="line">    guil-&gt;detect(grayImage, positionGuil);</div></div><!-- fragment --><p> As mentioned above, this step will take some time, especially with larger images and when using Guil.</p>
<h3>Draw results and show image</h3>
<div class="fragment"><div class="line"><span class="comment">//  draw ballard</span></div><div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionBallard.begin(); iter != positionBallard.end(); ++iter) {</div><div class="line">        RotatedRect rRect = RotatedRect(<a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a>((*iter)[0], (*iter)[1]),</div><div class="line">                                        <a class="code" href="../../dc/d84/group__core__basic.html#gab34496d2466b5f69930ab74c70f117d4">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div><div class="line">                                        (*iter)[3]);</div><div class="line">        <a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a> vertices[4];</div><div class="line">        rRect.points(vertices);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line">            <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga7078a9fae8c7e7d13d24dac2520ae4a2">line</a>(image, vertices[i], vertices[(i + 1) % 4], <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(255, 0, 0), 6);</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="comment">//  draw guil</span></div><div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionGuil.begin(); iter != positionGuil.end(); ++iter) {</div><div class="line">        RotatedRect rRect = RotatedRect(<a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a>((*iter)[0], (*iter)[1]),</div><div class="line">                                        <a class="code" href="../../dc/d84/group__core__basic.html#gab34496d2466b5f69930ab74c70f117d4">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div><div class="line">                                        (*iter)[3]);</div><div class="line">        <a class="code" href="../../dc/d84/group__core__basic.html#ga7d080aa40de011e4410bca63385ffe2a">Point2f</a> vertices[4];</div><div class="line">        rRect.points(vertices);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line">            <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga7078a9fae8c7e7d13d24dac2520ae4a2">line</a>(image, vertices[i], vertices[(i + 1) % 4], <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(0, 255, 0), 2);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>(<span class="stringliteral">&quot;result_img&quot;</span>, image);</div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">waitKey</a>();</div></div><!-- fragment --> <h2>Result </h2>
<div class="image">
<img src="../../generalized_hough_result_img.jpg" alt="generalized_hough_result_img.jpg"/>
<div class="caption">
result image</div></div>
<p> The blue rectangle shows the result of <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> and the green rectangles the results of <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a>.</p>
<p>Getting perfect results like in this example is unlikely if the parameters are not perfectly adapted to the sample. An example with less perfect parameters is shown below. For the Ballard variant, only the center of the result is marked as a black dot on this image. The rectangle would be the same as on the previous image.</p>
<div class="image">
<img src="../../generalized_hough_less_perfect_result_img.jpg" alt="generalized_hough_less_perfect_result_img.jpg"/>
<div class="caption">
less perfect result</div></div>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 10 2023 23:35:44 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>

<!-- Mirrored from docs.opencv.org/4.x/da/ddc/tutorial_generalized_hough_ballard_guil.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 11 May 2023 10:23:25 GMT -->
</html>
